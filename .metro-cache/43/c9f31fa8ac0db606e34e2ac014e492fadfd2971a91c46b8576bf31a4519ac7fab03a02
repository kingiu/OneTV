{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":131,"column":2,"index":4333}}],"key":"7kvm5yrOpz4NYiDi6sn4qxa8DVQ="}},{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":131,"column":2,"index":4333}}],"key":"8I802z/QkQYw0PV6ZCqhBNDwn0Q="}},{"name":"react","data":{"asyncType":null,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":56,"index":56}}],"key":"a4EMkKqamYWCMMPV7UeQlqGQ+ks="}},{"name":"expo-av","data":{"asyncType":null,"locs":[{"start":{"line":2,"column":0,"index":57},"end":{"line":2,"column":44,"index":101}}],"key":"NRThymhwYB6oVmZMWQGMPRPDfzs="}},{"name":"react-native-toast-message","data":{"asyncType":null,"locs":[{"start":{"line":3,"column":0,"index":102},"end":{"line":3,"column":47,"index":149}}],"key":"mvLfpRqMmyOUTnGhKaiVkXHegIo="}},{"name":"@/stores/playerStore","data":{"asyncType":null,"locs":[{"start":{"line":4,"column":0,"index":150},"end":{"line":4,"column":50,"index":200}}],"key":"jza9oGwrWwCRqRJcTBeVqZHqd+Y="}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = require(_dependencyMap[0]);\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.useVideoHandlers = undefined;\n  var _asyncToGenerator2 = _interopRequireDefault(require(_dependencyMap[1]));\n  var _react = require(_dependencyMap[2]);\n  var _expoAv = require(_dependencyMap[3]);\n  var _reactNativeToastMessage = _interopRequireDefault(require(_dependencyMap[4]));\n  var _playerStore = _interopRequireDefault(require(_dependencyMap[5]));\n  var useVideoHandlers = function (_ref) {\n    var videoRef = _ref.videoRef,\n      currentEpisode = _ref.currentEpisode,\n      initialPosition = _ref.initialPosition,\n      introEndTime = _ref.introEndTime,\n      playbackRate = _ref.playbackRate,\n      handlePlaybackStatusUpdate = _ref.handlePlaybackStatusUpdate,\n      deviceType = _ref.deviceType,\n      detail = _ref.detail;\n    var onLoad = (0, _react.useCallback)(/*#__PURE__*/(0, _asyncToGenerator2.default)(function* () {\n      try {\n        // 1. 先设置位置（如果需要）\n        var jumpPosition = initialPosition || introEndTime || 0;\n        if (jumpPosition > 0) {\n          yield videoRef.current?.setPositionAsync(jumpPosition);\n        }\n\n        // 2. 显式调用播放以确保自动播放\n\n        yield videoRef.current?.playAsync();\n        _playerStore.default.setState({\n          isLoading: false\n        });\n      } catch (error) {\n        // 即使自动播放失败，也要设置加载完成状态\n        _playerStore.default.setState({\n          isLoading: false\n        });\n        // 不显示错误提示，因为自动播放失败是常见且预期的情况\n      }\n    }), [videoRef, initialPosition, introEndTime]);\n    var onLoadStart = (0, _react.useCallback)(function () {\n      if (!currentEpisode?.url) return;\n      _playerStore.default.setState({\n        isLoading: true\n      });\n    }, [currentEpisode?.url]);\n    var onError = (0, _react.useCallback)(function (error) {\n      if (!currentEpisode?.url) return;\n      // 检测SSL证书错误和其他网络错误\n      var errorString = error?.error?.toString() || error?.toString() || '';\n      var isSSLError = errorString.includes('SSLHandshakeException') || errorString.includes('CertPathValidatorException') || errorString.includes('Trust anchor for certification path not found');\n      var isNetworkError = errorString.includes('HttpDataSourceException') || errorString.includes('IOException') || errorString.includes('SocketTimeoutException');\n      if (isSSLError) {\n        _reactNativeToastMessage.default.show({\n          type: \"error\",\n          text1: \"SSL证书错误，正在尝试其他播放源...\",\n          text2: \"请稍候\"\n        });\n        _playerStore.default.getState().handleVideoError('ssl', currentEpisode.url);\n      } else if (isNetworkError) {\n        _reactNativeToastMessage.default.show({\n          type: \"error\",\n          text1: \"网络连接失败，正在尝试其他播放源...\",\n          text2: \"请稍候\"\n        });\n        _playerStore.default.getState().handleVideoError('network', currentEpisode.url);\n      } else {\n        _reactNativeToastMessage.default.show({\n          type: \"error\",\n          text1: \"视频播放失败，正在尝试其他播放源...\",\n          text2: \"请稍候\"\n        });\n        _playerStore.default.getState().handleVideoError('other', currentEpisode.url);\n      }\n    }, [currentEpisode?.url]);\n\n    // 优化的Video组件props\n    var videoProps = (0, _react.useMemo)(function () {\n      return {\n        source: {\n          uri: currentEpisode?.url || ''\n        },\n        posterSource: {\n          uri: detail?.poster ?? \"\"\n        },\n        resizeMode: _expoAv.ResizeMode.CONTAIN,\n        rate: playbackRate,\n        onPlaybackStatusUpdate: handlePlaybackStatusUpdate,\n        onLoad,\n        onLoadStart,\n        onError,\n        useNativeControls: deviceType !== 'tv',\n        shouldPlay: true\n      };\n    }, [currentEpisode?.url, detail?.poster, playbackRate, handlePlaybackStatusUpdate, onLoad, onLoadStart, onError, deviceType]);\n    return {\n      onLoad,\n      onLoadStart,\n      onError,\n      videoProps\n    };\n  };\n  exports.useVideoHandlers = useVideoHandlers;\n});","lineCount":106,"map":[[8,2,1,0],[8,6,1,0,"_react"],[8,12,1,0],[8,15,1,0,"require"],[8,22,1,0],[8,23,1,0,"_dependencyMap"],[8,37,1,0],[9,2,2,0],[9,6,2,0,"_expoAv"],[9,13,2,0],[9,16,2,0,"require"],[9,23,2,0],[9,24,2,0,"_dependencyMap"],[9,38,2,0],[10,2,3,0],[10,6,3,0,"_reactNativeToastMessage"],[10,30,3,0],[10,33,3,0,"_interopRequireDefault"],[10,55,3,0],[10,56,3,0,"require"],[10,63,3,0],[10,64,3,0,"_dependencyMap"],[10,78,3,0],[11,2,4,0],[11,6,4,0,"_playerStore"],[11,18,4,0],[11,21,4,0,"_interopRequireDefault"],[11,43,4,0],[11,44,4,0,"require"],[11,51,4,0],[11,52,4,0,"_dependencyMap"],[11,66,4,0],[12,2,17,7],[12,6,17,13,"useVideoHandlers"],[12,22,17,29],[12,25,17,32],[12,34,17,32,"useVideoHandlers"],[12,35,17,32,"_ref"],[12,39,17,32],[12,41,26,29],[13,4,26,29],[13,8,18,2,"videoRef"],[13,16,18,10],[13,19,18,10,"_ref"],[13,23,18,10],[13,24,18,2,"videoRef"],[13,32,18,10],[14,6,19,2,"currentEpisode"],[14,20,19,16],[14,23,19,16,"_ref"],[14,27,19,16],[14,28,19,2,"currentEpisode"],[14,42,19,16],[15,6,20,2,"initialPosition"],[15,21,20,17],[15,24,20,17,"_ref"],[15,28,20,17],[15,29,20,2,"initialPosition"],[15,44,20,17],[16,6,21,2,"introEndTime"],[16,18,21,14],[16,21,21,14,"_ref"],[16,25,21,14],[16,26,21,2,"introEndTime"],[16,38,21,14],[17,6,22,2,"playbackRate"],[17,18,22,14],[17,21,22,14,"_ref"],[17,25,22,14],[17,26,22,2,"playbackRate"],[17,38,22,14],[18,6,23,2,"handlePlaybackStatusUpdate"],[18,32,23,28],[18,35,23,28,"_ref"],[18,39,23,28],[18,40,23,2,"handlePlaybackStatusUpdate"],[18,66,23,28],[19,6,24,2,"deviceType"],[19,16,24,12],[19,19,24,12,"_ref"],[19,23,24,12],[19,24,24,2,"deviceType"],[19,34,24,12],[20,6,25,2,"detail"],[20,12,25,8],[20,15,25,8,"_ref"],[20,19,25,8],[20,20,25,2,"detail"],[20,26,25,8],[21,4,28,2],[21,8,28,8,"onLoad"],[21,14,28,14],[21,17,28,17],[21,21,28,17,"useCallback"],[21,39,28,28],[21,58,28,28,"_asyncToGenerator2"],[21,76,28,28],[21,77,28,28,"default"],[21,84,28,28],[21,86,28,29],[21,99,28,41],[22,6,31,4],[22,10,31,8],[23,8,32,6],[24,8,33,6],[24,12,33,12,"jumpPosition"],[24,24,33,24],[24,27,33,27,"initialPosition"],[24,42,33,42],[24,46,33,46,"introEndTime"],[24,58,33,58],[24,62,33,62],[24,63,33,63],[25,8,34,6],[25,12,34,10,"jumpPosition"],[25,24,34,22],[25,27,34,25],[25,28,34,26],[25,30,34,28],[26,10,36,8],[26,16,36,14,"videoRef"],[26,24,36,22],[26,25,36,23,"current"],[26,32,36,30],[26,34,36,32,"setPositionAsync"],[26,50,36,48],[26,51,36,49,"jumpPosition"],[26,63,36,61],[26,64,36,62],[27,8,37,6],[29,8,39,6],[31,8,41,6],[31,14,41,12,"videoRef"],[31,22,41,20],[31,23,41,21,"current"],[31,30,41,28],[31,32,41,30,"playAsync"],[31,41,41,39],[31,42,41,40],[31,43,41,41],[32,8,44,6,"usePlayerStore"],[32,28,44,20],[32,29,44,21,"setState"],[32,37,44,29],[32,38,44,30],[33,10,44,32,"isLoading"],[33,19,44,41],[33,21,44,43],[34,8,44,49],[34,9,44,50],[34,10,44,51],[35,6,46,4],[35,7,46,5],[35,8,46,6],[35,15,46,13,"error"],[35,20,46,18],[35,22,46,20],[36,8,48,6],[37,8,49,6,"usePlayerStore"],[37,28,49,20],[37,29,49,21,"setState"],[37,37,49,29],[37,38,49,30],[38,10,49,32,"isLoading"],[38,19,49,41],[38,21,49,43],[39,8,49,49],[39,9,49,50],[39,10,49,51],[40,8,50,6],[41,6,51,4],[42,4,52,2],[42,5,52,3],[42,8,52,5],[42,9,52,6,"videoRef"],[42,17,52,14],[42,19,52,16,"initialPosition"],[42,34,52,31],[42,36,52,33,"introEndTime"],[42,48,52,45],[42,49,52,46],[42,50,52,47],[43,4,54,2],[43,8,54,8,"onLoadStart"],[43,19,54,19],[43,22,54,22],[43,26,54,22,"useCallback"],[43,44,54,33],[43,46,54,34],[43,58,54,40],[44,6,55,4],[44,10,55,8],[44,11,55,9,"currentEpisode"],[44,25,55,23],[44,27,55,25,"url"],[44,30,55,28],[44,32,55,30],[45,6,58,4,"usePlayerStore"],[45,26,58,18],[45,27,58,19,"setState"],[45,35,58,27],[45,36,58,28],[46,8,58,30,"isLoading"],[46,17,58,39],[46,19,58,41],[47,6,58,46],[47,7,58,47],[47,8,58,48],[48,4,59,2],[48,5,59,3],[48,7,59,5],[48,8,59,6,"currentEpisode"],[48,22,59,20],[48,24,59,22,"url"],[48,27,59,25],[48,28,59,26],[48,29,59,27],[49,4,61,2],[49,8,61,8,"onError"],[49,15,61,15],[49,18,61,18],[49,22,61,18,"useCallback"],[49,40,61,29],[49,42,61,30],[49,52,61,31,"error"],[49,57,61,41],[49,59,61,46],[50,6,62,4],[50,10,62,8],[50,11,62,9,"currentEpisode"],[50,25,62,23],[50,27,62,25,"url"],[50,30,62,28],[50,32,62,30],[51,6,66,4],[52,6,67,4],[52,10,67,10,"errorString"],[52,21,67,21],[52,24,67,25,"error"],[52,29,67,30],[52,31,67,40,"error"],[52,36,67,45],[52,38,67,47,"toString"],[52,46,67,55],[52,47,67,56],[52,48,67,57],[52,52,67,61,"error"],[52,57,67,66],[52,59,67,68,"toString"],[52,67,67,76],[52,68,67,77],[52,69,67,78],[52,73,67,82],[52,75,67,84],[53,6,68,4],[53,10,68,10,"isSSLError"],[53,20,68,20],[53,23,68,23,"errorString"],[53,34,68,34],[53,35,68,35,"includes"],[53,43,68,43],[53,44,68,44],[53,67,68,67],[53,68,68,68],[53,72,69,22,"errorString"],[53,83,69,33],[53,84,69,34,"includes"],[53,92,69,42],[53,93,69,43],[53,121,69,71],[53,122,69,72],[53,126,70,22,"errorString"],[53,137,70,33],[53,138,70,34,"includes"],[53,146,70,42],[53,147,70,43],[53,194,70,90],[53,195,70,91],[54,6,71,4],[54,10,71,10,"isNetworkError"],[54,24,71,24],[54,27,71,27,"errorString"],[54,38,71,38],[54,39,71,39,"includes"],[54,47,71,47],[54,48,71,48],[54,73,71,73],[54,74,71,74],[54,78,72,25,"errorString"],[54,89,72,36],[54,90,72,37,"includes"],[54,98,72,45],[54,99,72,46],[54,112,72,59],[54,113,72,60],[54,117,73,25,"errorString"],[54,128,73,36],[54,129,73,37,"includes"],[54,137,73,45],[54,138,73,46],[54,162,73,70],[54,163,73,71],[55,6,75,4],[55,10,75,8,"isSSLError"],[55,20,75,18],[55,22,75,20],[56,8,77,6,"Toast"],[56,40,77,11],[56,41,77,12,"show"],[56,45,77,16],[56,46,77,17],[57,10,78,8,"type"],[57,14,78,12],[57,16,78,14],[57,23,78,21],[58,10,79,8,"text1"],[58,15,79,13],[58,17,79,15],[58,39,79,37],[59,10,80,8,"text2"],[59,15,80,13],[59,17,80,15],[60,8,81,6],[60,9,81,7],[60,10,81,8],[61,8,82,6,"usePlayerStore"],[61,28,82,20],[61,29,82,21,"getState"],[61,37,82,29],[61,38,82,30],[61,39,82,31],[61,40,82,32,"handleVideoError"],[61,56,82,48],[61,57,82,49],[61,62,82,54],[61,64,82,56,"currentEpisode"],[61,78,82,70],[61,79,82,71,"url"],[61,82,82,74],[61,83,82,75],[62,6,83,4],[62,7,83,5],[62,13,83,11],[62,17,83,15,"isNetworkError"],[62,31,83,29],[62,33,83,31],[63,8,85,6,"Toast"],[63,40,85,11],[63,41,85,12,"show"],[63,45,85,16],[63,46,85,17],[64,10,86,8,"type"],[64,14,86,12],[64,16,86,14],[64,23,86,21],[65,10,87,8,"text1"],[65,15,87,13],[65,17,87,15],[65,38,87,36],[66,10,88,8,"text2"],[66,15,88,13],[66,17,88,15],[67,8,89,6],[67,9,89,7],[67,10,89,8],[68,8,90,6,"usePlayerStore"],[68,28,90,20],[68,29,90,21,"getState"],[68,37,90,29],[68,38,90,30],[68,39,90,31],[68,40,90,32,"handleVideoError"],[68,56,90,48],[68,57,90,49],[68,66,90,58],[68,68,90,60,"currentEpisode"],[68,82,90,74],[68,83,90,75,"url"],[68,86,90,78],[68,87,90,79],[69,6,91,4],[69,7,91,5],[69,13,91,11],[70,8,93,6,"Toast"],[70,40,93,11],[70,41,93,12,"show"],[70,45,93,16],[70,46,93,17],[71,10,94,8,"type"],[71,14,94,12],[71,16,94,14],[71,23,94,21],[72,10,95,8,"text1"],[72,15,95,13],[72,17,95,15],[72,38,95,36],[73,10,96,8,"text2"],[73,15,96,13],[73,17,96,15],[74,8,97,6],[74,9,97,7],[74,10,97,8],[75,8,98,6,"usePlayerStore"],[75,28,98,20],[75,29,98,21,"getState"],[75,37,98,29],[75,38,98,30],[75,39,98,31],[75,40,98,32,"handleVideoError"],[75,56,98,48],[75,57,98,49],[75,64,98,56],[75,66,98,58,"currentEpisode"],[75,80,98,72],[75,81,98,73,"url"],[75,84,98,76],[75,85,98,77],[76,6,99,4],[77,4,100,2],[77,5,100,3],[77,7,100,5],[77,8,100,6,"currentEpisode"],[77,22,100,20],[77,24,100,22,"url"],[77,27,100,25],[77,28,100,26],[77,29,100,27],[79,4,102,2],[80,4,103,2],[80,8,103,8,"videoProps"],[80,18,103,18],[80,21,103,21],[80,25,103,21,"useMemo"],[80,39,103,28],[80,41,103,29],[81,6,103,29],[81,13,103,36],[82,8,104,4,"source"],[82,14,104,10],[82,16,104,12],[83,10,104,14,"uri"],[83,13,104,17],[83,15,104,19,"currentEpisode"],[83,29,104,33],[83,31,104,35,"url"],[83,34,104,38],[83,38,104,42],[84,8,104,45],[84,9,104,46],[85,8,105,4,"posterSource"],[85,20,105,16],[85,22,105,18],[86,10,105,20,"uri"],[86,13,105,23],[86,15,105,25,"detail"],[86,21,105,31],[86,23,105,33,"poster"],[86,29,105,39],[86,33,105,43],[87,8,105,46],[87,9,105,47],[88,8,106,4,"resizeMode"],[88,18,106,14],[88,20,106,16,"ResizeMode"],[88,38,106,26],[88,39,106,27,"CONTAIN"],[88,46,106,34],[89,8,107,4,"rate"],[89,12,107,8],[89,14,107,10,"playbackRate"],[89,26,107,22],[90,8,108,4,"onPlaybackStatusUpdate"],[90,30,108,26],[90,32,108,28,"handlePlaybackStatusUpdate"],[90,58,108,54],[91,8,109,4,"onLoad"],[91,14,109,10],[92,8,110,4,"onLoadStart"],[92,19,110,15],[93,8,111,4,"onError"],[93,15,111,11],[94,8,112,4,"useNativeControls"],[94,25,112,21],[94,27,112,23,"deviceType"],[94,37,112,33],[94,42,112,38],[94,46,112,42],[95,8,113,4,"shouldPlay"],[95,18,113,14],[95,20,113,16],[96,6,114,2],[96,7,114,3],[97,4,114,3],[97,5,114,4],[97,7,114,6],[97,8,115,4,"currentEpisode"],[97,22,115,18],[97,24,115,20,"url"],[97,27,115,23],[97,29,116,4,"detail"],[97,35,116,10],[97,37,116,12,"poster"],[97,43,116,18],[97,45,117,4,"playbackRate"],[97,57,117,16],[97,59,118,4,"handlePlaybackStatusUpdate"],[97,85,118,30],[97,87,119,4,"onLoad"],[97,93,119,10],[97,95,120,4,"onLoadStart"],[97,106,120,15],[97,108,121,4,"onError"],[97,115,121,11],[97,117,122,4,"deviceType"],[97,127,122,14],[97,128,123,3],[97,129,123,4],[98,4,125,2],[98,11,125,9],[99,6,126,4,"onLoad"],[99,12,126,10],[100,6,127,4,"onLoadStart"],[100,17,127,15],[101,6,128,4,"onError"],[101,13,128,11],[102,6,129,4,"videoProps"],[103,4,130,2],[103,5,130,3],[104,2,131,0],[104,3,131,1],[105,2,131,2,"exports"],[105,9,131,2],[105,10,131,2,"useVideoHandlers"],[105,26,131,2],[105,29,131,2,"useVideoHandlers"],[105,45,131,2],[106,0,131,2]],"functionMap":{"names":["<global>","useVideoHandlers","onLoad","onLoadStart","onError","useMemo$argument_0"],"mappings":"AAA;gCCgB;6BCW;GDwB;kCEE;GFK;8BGE;GHuC;6BIG;IJW;CDiB"}},"type":"js/module"}]}