{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":95,"column":4,"index":2828}}],"key":"7kvm5yrOpz4NYiDi6sn4qxa8DVQ="}},{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":95,"column":4,"index":2828}}],"key":"8I802z/QkQYw0PV6ZCqhBNDwn0Q="}},{"name":"zustand","data":{"asyncType":null,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":33,"index":33}}],"key":"xFAZpEovr+Y5/UCynUzO0ntFekY="}},{"name":"@/services/remoteControlService","data":{"asyncType":null,"locs":[{"start":{"line":2,"column":0,"index":34},"end":{"line":2,"column":71,"index":105}}],"key":"Cg1ythM7J2c7A5BKZSxh0wlfyLM="}},{"name":"@/utils/Logger","data":{"asyncType":null,"locs":[{"start":{"line":3,"column":0,"index":106},"end":{"line":3,"column":36,"index":142}}],"key":"dpbJvsqVW0VVfFOl8dlhEC6KfVk="}},{"name":"react-native","data":{"asyncType":null,"locs":[{"start":{"line":4,"column":0,"index":143},"end":{"line":4,"column":40,"index":183}}],"key":"XEo4Z+Aarw9Y7I7ZLBt66vGLAVQ="}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = require(_dependencyMap[0]);\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.useRemoteControlStore = undefined;\n  var _asyncToGenerator2 = _interopRequireDefault(require(_dependencyMap[1]));\n  var _zustand = require(_dependencyMap[2]);\n  var _remoteControlService = require(_dependencyMap[3]);\n  var _Logger = _interopRequireDefault(require(_dependencyMap[4]));\n  var _reactNative = require(_dependencyMap[5]);\n  var logger = _Logger.default.withTag('RemoteControlStore');\n  var useRemoteControlStore = exports.useRemoteControlStore = (0, _zustand.create)(function (set, get) {\n    return {\n      isServerRunning: false,\n      serverUrl: null,\n      error: null,\n      isModalVisible: false,\n      lastMessage: null,\n      targetPage: null,\n      startServer: function () {\n        var _ref = (0, _asyncToGenerator2.default)(function* () {\n          if (get().isServerRunning) {\n            return;\n          }\n\n          // 在Web平台上禁用远程输入服务器功能\n\n          _remoteControlService.remoteControlService.init({\n            onMessage: function (message) {\n              logger.debug('Received message:', message);\n              var currentState = get();\n              // Use the current targetPage from the store\n              set({\n                lastMessage: message,\n                targetPage: currentState.targetPage\n              });\n            },\n            onHandshake: function () {\n              logger.debug('Handshake successful');\n              set({\n                isModalVisible: false\n              });\n            }\n          });\n          try {\n            // 确保服务已正确初始化\n            if (!_remoteControlService.remoteControlService) {\n              throw new Error('远程控制服务未正确初始化');\n            }\n\n            // 检查服务是否已经运行\n            if (_remoteControlService.remoteControlService.isRunning()) {\n              logger.debug('Remote control service is already running');\n              return;\n            }\n            var url = yield _remoteControlService.remoteControlService.startServer();\n            logger.info('Server started, URL:', url);\n            set({\n              isServerRunning: true,\n              serverUrl: url,\n              error: null\n            });\n          } catch (error) {\n            var _errorMessage = error instanceof Error ? error.message : '启动失败，请强制退应用后重试。';\n            logger.error('Failed to start server:', _errorMessage);\n            set({\n              error: _errorMessage\n            });\n          }\n        });\n        return function startServer() {\n          return _ref.apply(this, arguments);\n        };\n      }(),\n      stopServer: function () {\n        if (get().isServerRunning) {\n          _remoteControlService.remoteControlService.stopServer();\n          set({\n            isServerRunning: false,\n            serverUrl: null\n          });\n        }\n      },\n      showModal: function (targetPage) {\n        return set({\n          isModalVisible: true,\n          targetPage\n        });\n      },\n      hideModal: function () {\n        return set({\n          isModalVisible: false,\n          targetPage: null\n        });\n      },\n      setMessage: function (message, targetPage) {\n        set({\n          lastMessage: `${message}_${Date.now()}`,\n          targetPage\n        });\n      },\n      clearMessage: function () {\n        set({\n          lastMessage: null,\n          targetPage: null\n        });\n      }\n    };\n  });\n});","lineCount":111,"map":[[8,2,1,0],[8,6,1,0,"_zustand"],[8,14,1,0],[8,17,1,0,"require"],[8,24,1,0],[8,25,1,0,"_dependencyMap"],[8,39,1,0],[9,2,2,0],[9,6,2,0,"_remoteControlService"],[9,27,2,0],[9,30,2,0,"require"],[9,37,2,0],[9,38,2,0,"_dependencyMap"],[9,52,2,0],[10,2,3,0],[10,6,3,0,"_Logger"],[10,13,3,0],[10,16,3,0,"_interopRequireDefault"],[10,38,3,0],[10,39,3,0,"require"],[10,46,3,0],[10,47,3,0,"_dependencyMap"],[10,61,3,0],[11,2,4,0],[11,6,4,0,"_reactNative"],[11,18,4,0],[11,21,4,0,"require"],[11,28,4,0],[11,29,4,0,"_dependencyMap"],[11,43,4,0],[12,2,6,0],[12,6,6,6,"logger"],[12,12,6,12],[12,15,6,15,"Logger"],[12,30,6,21],[12,31,6,22,"withTag"],[12,38,6,29],[12,39,6,30],[12,59,6,50],[12,60,6,51],[13,2,23,7],[13,6,23,13,"useRemoteControlStore"],[13,27,23,34],[13,30,23,34,"exports"],[13,37,23,34],[13,38,23,34,"useRemoteControlStore"],[13,59,23,34],[13,62,23,37],[13,66,23,37,"create"],[13,81,23,43],[13,83,23,64],[13,93,23,65,"set"],[13,96,23,68],[13,98,23,70,"get"],[13,101,23,73],[14,4,23,73],[14,11,23,79],[15,6,24,2,"isServerRunning"],[15,21,24,17],[15,23,24,19],[15,28,24,24],[16,6,25,2,"serverUrl"],[16,15,25,11],[16,17,25,13],[16,21,25,17],[17,6,26,2,"error"],[17,11,26,7],[17,13,26,9],[17,17,26,13],[18,6,27,2,"isModalVisible"],[18,20,27,16],[18,22,27,18],[18,27,27,23],[19,6,28,2,"lastMessage"],[19,17,28,13],[19,19,28,15],[19,23,28,19],[20,6,29,2,"targetPage"],[20,16,29,12],[20,18,29,14],[20,22,29,18],[21,6,31,2,"startServer"],[21,17,31,13],[22,8,31,13],[22,12,31,13,"_ref"],[22,16,31,13],[22,23,31,13,"_asyncToGenerator2"],[22,41,31,13],[22,42,31,13,"default"],[22,49,31,13],[22,51,31,15],[22,64,31,27],[23,10,32,4],[23,14,32,8,"get"],[23,17,32,11],[23,18,32,12],[23,19,32,13],[23,20,32,14,"isServerRunning"],[23,35,32,29],[23,37,32,31],[24,12,33,6],[25,10,34,4],[27,10,36,4],[29,10,44,4,"remoteControlService"],[29,52,44,24],[29,53,44,25,"init"],[29,57,44,29],[29,58,44,30],[30,12,45,6,"onMessage"],[30,21,45,15],[30,23,45,17],[30,32,45,17,"onMessage"],[30,33,45,18,"message"],[30,40,45,33],[30,42,45,38],[31,14,46,8,"logger"],[31,20,46,14],[31,21,46,15,"debug"],[31,26,46,20],[31,27,46,21],[31,46,46,40],[31,48,46,42,"message"],[31,55,46,49],[31,56,46,50],[32,14,47,8],[32,18,47,14,"currentState"],[32,30,47,26],[32,33,47,29,"get"],[32,36,47,32],[32,37,47,33],[32,38,47,34],[33,14,48,8],[34,14,49,8,"set"],[34,17,49,11],[34,18,49,12],[35,16,49,14,"lastMessage"],[35,27,49,25],[35,29,49,27,"message"],[35,36,49,34],[36,16,49,36,"targetPage"],[36,26,49,46],[36,28,49,48,"currentState"],[36,40,49,60],[36,41,49,61,"targetPage"],[37,14,49,72],[37,15,49,73],[37,16,49,74],[38,12,50,6],[38,13,50,7],[39,12,51,6,"onHandshake"],[39,23,51,17],[39,25,51,19],[39,34,51,19,"onHandshake"],[39,35,51,19],[39,37,51,25],[40,14,52,8,"logger"],[40,20,52,14],[40,21,52,15,"debug"],[40,26,52,20],[40,27,52,21],[40,49,52,43],[40,50,52,44],[41,14,53,8,"set"],[41,17,53,11],[41,18,53,12],[42,16,53,14,"isModalVisible"],[42,30,53,28],[42,32,53,30],[43,14,53,36],[43,15,53,37],[43,16,53,38],[44,12,54,6],[45,10,55,4],[45,11,55,5],[45,12,55,6],[46,10,56,4],[46,14,56,8],[47,12,57,6],[48,12,58,6],[48,16,58,10],[48,17,58,11,"remoteControlService"],[48,59,58,31],[48,61,58,33],[49,14,59,8],[49,20,59,14],[49,24,59,18,"Error"],[49,29,59,23],[49,30,59,24],[49,44,59,38],[49,45,59,39],[50,12,60,6],[52,12,62,6],[53,12,63,6],[53,16,63,10,"remoteControlService"],[53,58,63,30],[53,59,63,31,"isRunning"],[53,68,63,40],[53,69,63,41],[53,70,63,42],[53,72,63,44],[54,14,64,8,"logger"],[54,20,64,14],[54,21,64,15,"debug"],[54,26,64,20],[54,27,64,21],[54,70,64,64],[54,71,64,65],[55,14,65,8],[56,12,66,6],[57,12,68,6],[57,16,68,12,"url"],[57,19,68,15],[57,28,68,24,"remoteControlService"],[57,70,68,44],[57,71,68,45,"startServer"],[57,82,68,56],[57,83,68,57],[57,84,68,58],[58,12,69,6,"logger"],[58,18,69,12],[58,19,69,13,"info"],[58,23,69,17],[58,24,69,18],[58,46,69,40],[58,48,69,42,"url"],[58,51,69,45],[58,52,69,46],[59,12,70,6,"set"],[59,15,70,9],[59,16,70,10],[60,14,70,12,"isServerRunning"],[60,29,70,27],[60,31,70,29],[60,35,70,33],[61,14,70,35,"serverUrl"],[61,23,70,44],[61,25,70,46,"url"],[61,28,70,49],[62,14,70,51,"error"],[62,19,70,56],[62,21,70,58],[63,12,70,63],[63,13,70,64],[63,14,70,65],[64,10,71,4],[64,11,71,5],[64,12,71,6],[64,19,71,13,"error"],[64,24,71,18],[64,26,71,20],[65,12,72,6],[65,16,72,12,"errorMessage"],[65,29,72,24],[65,32,72,27,"error"],[65,37,72,32],[65,49,72,44,"Error"],[65,54,72,49],[65,57,72,52,"error"],[65,62,72,57],[65,63,72,58,"message"],[65,70,72,65],[65,73,72,68],[65,90,72,85],[66,12,73,6,"logger"],[66,18,73,12],[66,19,73,13,"error"],[66,24,73,18],[66,25,73,19],[66,50,73,44],[66,52,73,46,"errorMessage"],[66,65,73,58],[66,66,73,59],[67,12,74,6,"set"],[67,15,74,9],[67,16,74,10],[68,14,74,12,"error"],[68,19,74,17],[68,21,74,19,"errorMessage"],[69,12,74,32],[69,13,74,33],[69,14,74,34],[70,10,75,4],[71,8,76,2],[71,9,76,3],[72,8,76,3],[72,24,31,2,"startServer"],[72,35,31,13,"startServer"],[72,36,31,13],[73,10,31,13],[73,17,31,13,"_ref"],[73,21,31,13],[73,22,31,13,"apply"],[73,27,31,13],[73,34,31,13,"arguments"],[73,43,31,13],[74,8,31,13],[75,6,31,13],[75,9,76,3],[76,6,78,2,"stopServer"],[76,16,78,12],[76,18,78,14],[76,27,78,14,"stopServer"],[76,28,78,14],[76,30,78,20],[77,8,79,4],[77,12,79,8,"get"],[77,15,79,11],[77,16,79,12],[77,17,79,13],[77,18,79,14,"isServerRunning"],[77,33,79,29],[77,35,79,31],[78,10,80,6,"remoteControlService"],[78,52,80,26],[78,53,80,27,"stopServer"],[78,63,80,37],[78,64,80,38],[78,65,80,39],[79,10,81,6,"set"],[79,13,81,9],[79,14,81,10],[80,12,81,12,"isServerRunning"],[80,27,81,27],[80,29,81,29],[80,34,81,34],[81,12,81,36,"serverUrl"],[81,21,81,45],[81,23,81,47],[82,10,81,52],[82,11,81,53],[82,12,81,54],[83,8,82,4],[84,6,83,2],[84,7,83,3],[85,6,85,2,"showModal"],[85,15,85,11],[85,17,85,13],[85,26,85,13,"showModal"],[85,27,85,14,"targetPage"],[85,37,85,33],[86,8,85,33],[86,15,85,38,"set"],[86,18,85,41],[86,19,85,42],[87,10,85,44,"isModalVisible"],[87,24,85,58],[87,26,85,60],[87,30,85,64],[88,10,85,66,"targetPage"],[89,8,85,77],[89,9,85,78],[89,10,85,79],[90,6,85,79],[91,6,86,2,"hideModal"],[91,15,86,11],[91,17,86,13],[91,26,86,13,"hideModal"],[91,27,86,13],[92,8,86,13],[92,15,86,19,"set"],[92,18,86,22],[92,19,86,23],[93,10,86,25,"isModalVisible"],[93,24,86,39],[93,26,86,41],[93,31,86,46],[94,10,86,48,"targetPage"],[94,20,86,58],[94,22,86,60],[95,8,86,65],[95,9,86,66],[95,10,86,67],[96,6,86,67],[97,6,88,2,"setMessage"],[97,16,88,12],[97,18,88,14],[97,27,88,14,"setMessage"],[97,28,88,15,"message"],[97,35,88,30],[97,37,88,32,"targetPage"],[97,47,88,51],[97,49,88,56],[98,8,89,4,"set"],[98,11,89,7],[98,12,89,8],[99,10,89,10,"lastMessage"],[99,21,89,21],[99,23,89,23],[99,26,89,26,"message"],[99,33,89,33],[99,37,89,37,"Date"],[99,41,89,41],[99,42,89,42,"now"],[99,45,89,45],[99,46,89,46],[99,47,89,47],[99,49,89,49],[100,10,89,51,"targetPage"],[101,8,89,62],[101,9,89,63],[101,10,89,64],[102,6,90,2],[102,7,90,3],[103,6,92,2,"clearMessage"],[103,18,92,14],[103,20,92,16],[103,29,92,16,"clearMessage"],[103,30,92,16],[103,32,92,22],[104,8,93,4,"set"],[104,11,93,7],[104,12,93,8],[105,10,93,10,"lastMessage"],[105,21,93,21],[105,23,93,23],[105,27,93,27],[106,10,93,29,"targetPage"],[106,20,93,39],[106,22,93,41],[107,8,93,46],[107,9,93,47],[107,10,93,48],[108,6,94,2],[109,4,95,0],[109,5,95,1],[110,2,95,1],[110,3,95,2],[110,4,95,3],[111,0,95,4]],"functionMap":{"names":["<global>","create$argument_0","startServer","remoteControlService.init$argument_0.onMessage","remoteControlService.init$argument_0.onHandshake","stopServer","showModal","hideModal","setMessage","clearMessage"],"mappings":"AAA;gECsB;eCQ;iBCc;ODK;mBEC;OFG;GDsB;cIE;GJK;aKE,kEL;aMC,sDN;cOE;GPE;gBQE;GRE;EDC"}},"type":"js/module"}]}