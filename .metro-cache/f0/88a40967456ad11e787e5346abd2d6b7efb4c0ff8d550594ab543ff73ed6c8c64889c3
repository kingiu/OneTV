{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":141,"column":0,"index":3498}}],"key":"7kvm5yrOpz4NYiDi6sn4qxa8DVQ="}},{"name":"react","data":{"asyncType":null,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":55,"index":55}}],"key":"a4EMkKqamYWCMMPV7UeQlqGQ+ks="}},{"name":"react-native","data":{"asyncType":null,"locs":[{"start":{"line":2,"column":0,"index":56},"end":{"line":2,"column":49,"index":105}}],"key":"XEo4Z+Aarw9Y7I7ZLBt66vGLAVQ="}},{"name":"../stores/playerStore","data":{"asyncType":null,"locs":[{"start":{"line":3,"column":0,"index":106},"end":{"line":3,"column":50,"index":156}}],"key":"IqIRCjYc+BYOz73vlGmXzcU79vg="}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = require(_dependencyMap[0]);\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.useTVRemoteHandler = undefined;\n  var _react = require(_dependencyMap[1]);\n  var _reactNative = require(_dependencyMap[2]);\n  var _playerStore = _interopRequireDefault(require(_dependencyMap[3]));\n  var SEEK_STEP = 20000; // 快进/快退的时间步长（毫秒）\n\n  // 定时器延迟时间（毫秒）\n  var CONTROLS_TIMEOUT = 5000;\n\n  // 定义遥控器事件类型\n\n  /**\n   * 管理播放器控件的显示/隐藏、遥控器事件和自动隐藏定时器。\n   * @returns onScreenPress - 一个函数，用于处理屏幕点击事件，以显示控件并重置定时器。\n   */\n  var useTVRemoteHandler = function () {\n    var _usePlayerStore = (0, _playerStore.default)(),\n      showControls = _usePlayerStore.showControls,\n      setShowControls = _usePlayerStore.setShowControls,\n      showEpisodeModal = _usePlayerStore.showEpisodeModal,\n      togglePlayPause = _usePlayerStore.togglePlayPause,\n      seek = _usePlayerStore.seek;\n    var controlsTimer = (0, _react.useRef)(null);\n    var fastForwardIntervalRef = (0, _react.useRef)(null);\n\n    // 重置或启动隐藏控件的定时器\n    var resetTimer = (0, _react.useCallback)(function () {\n      // 清除之前的定时器\n      if (controlsTimer.current) {\n        clearTimeout(controlsTimer.current);\n      }\n      // 设置新的定时器\n      controlsTimer.current = setTimeout(function () {\n        setShowControls(false);\n      }, CONTROLS_TIMEOUT);\n    }, [setShowControls]);\n\n    // 当控件显示时，启动定时器\n    (0, _react.useEffect)(function () {\n      if (showControls) {\n        resetTimer();\n      } else {\n        // 如果控件被隐藏，清除定时器\n        if (controlsTimer.current) {\n          clearTimeout(controlsTimer.current);\n        }\n      }\n\n      // 组件卸载时清除定时器\n      return function () {\n        if (controlsTimer.current) {\n          clearTimeout(controlsTimer.current);\n        }\n      };\n    }, [showControls, resetTimer]);\n\n    // 组件卸载时清除快进定时器\n    (0, _react.useEffect)(function () {\n      return function () {\n        if (fastForwardIntervalRef.current) {\n          clearInterval(fastForwardIntervalRef.current);\n        }\n      };\n    }, []);\n\n    // 处理遥控器事件\n    var handleTVEvent = (0, _react.useCallback)(function (event) {\n      if (showEpisodeModal) {\n        return;\n      }\n      if (event.eventType === \"longRight\" || event.eventType === \"longLeft\") {\n        if (event.eventKeyAction === 1) {\n          if (fastForwardIntervalRef.current) {\n            clearInterval(fastForwardIntervalRef.current);\n            fastForwardIntervalRef.current = null;\n          }\n        }\n      }\n      resetTimer();\n      if (showControls) {\n        // 如果控制条已显示，则不处理后台的快进/快退等操作\n        // 避免与控制条上的按钮焦点冲突\n        return;\n      }\n      switch (event.eventType) {\n        case \"select\":\n          togglePlayPause();\n          setShowControls(true);\n          break;\n        case \"left\":\n          seek(-20000); // 快退15秒\n          break;\n        case \"longLeft\":\n          if (!fastForwardIntervalRef.current && event.eventKeyAction === 0) {\n            fastForwardIntervalRef.current = setInterval(function () {\n              seek(-20000);\n            }, 200);\n          }\n          break;\n        case \"right\":\n          seek(SEEK_STEP);\n          break;\n        case \"longRight\":\n          // 长按开始: 启动连续快进\n          if (!fastForwardIntervalRef.current && event.eventKeyAction === 0) {\n            fastForwardIntervalRef.current = setInterval(function () {\n              seek(SEEK_STEP);\n            }, 200);\n          }\n          break;\n        case \"down\":\n          setShowControls(true);\n          break;\n      }\n    }, [showControls, showEpisodeModal, setShowControls, resetTimer, togglePlayPause, seek]);\n\n    // 使用类型断言确保兼容性\n    (0, _reactNative.useTVEventHandler)(handleTVEvent);\n\n    // 处理屏幕点击事件\n    var onScreenPress = function () {\n      // 切换控件的显示状态\n      var newShowControls = !showControls;\n      setShowControls(newShowControls);\n\n      // 如果控件变为显示状态，则重置定时器\n      if (newShowControls) {\n        resetTimer();\n      }\n    };\n    return {\n      onScreenPress\n    };\n  };\n  exports.useTVRemoteHandler = useTVRemoteHandler;\n});","lineCount":141,"map":[[7,2,1,0],[7,6,1,0,"_react"],[7,12,1,0],[7,15,1,0,"require"],[7,22,1,0],[7,23,1,0,"_dependencyMap"],[7,37,1,0],[8,2,2,0],[8,6,2,0,"_reactNative"],[8,18,2,0],[8,21,2,0,"require"],[8,28,2,0],[8,29,2,0,"_dependencyMap"],[8,43,2,0],[9,2,3,0],[9,6,3,0,"_playerStore"],[9,18,3,0],[9,21,3,0,"_interopRequireDefault"],[9,43,3,0],[9,44,3,0,"require"],[9,51,3,0],[9,52,3,0,"_dependencyMap"],[9,66,3,0],[10,2,5,0],[10,6,5,6,"SEEK_STEP"],[10,15,5,15],[10,23,5,27],[10,24,5,28],[10,25,5,29],[12,2,7,0],[13,2,8,0],[13,6,8,6,"CONTROLS_TIMEOUT"],[13,22,8,22],[13,25,8,25],[13,29,8,29],[15,2,10,0],[17,2,16,0],[18,0,17,0],[19,0,18,0],[20,0,19,0],[21,2,20,7],[21,6,20,13,"useTVRemoteHandler"],[21,24,20,31],[21,27,20,34],[21,36,20,34,"useTVRemoteHandler"],[21,37,20,34],[21,39,20,40],[22,4,21,2],[22,8,21,2,"_usePlayerStore"],[22,23,21,2],[22,26,21,85],[22,30,21,85,"usePlayerStore"],[22,50,21,99],[22,52,21,100],[22,53,21,101],[23,6,21,10,"showControls"],[23,18,21,22],[23,21,21,22,"_usePlayerStore"],[23,36,21,22],[23,37,21,10,"showControls"],[23,49,21,22],[24,6,21,24,"setShowControls"],[24,21,21,39],[24,24,21,39,"_usePlayerStore"],[24,39,21,39],[24,40,21,24,"setShowControls"],[24,55,21,39],[25,6,21,41,"showEpisodeModal"],[25,22,21,57],[25,25,21,57,"_usePlayerStore"],[25,40,21,57],[25,41,21,41,"showEpisodeModal"],[25,57,21,57],[26,6,21,59,"togglePlayPause"],[26,21,21,74],[26,24,21,74,"_usePlayerStore"],[26,39,21,74],[26,40,21,59,"togglePlayPause"],[26,55,21,74],[27,6,21,76,"seek"],[27,10,21,80],[27,13,21,80,"_usePlayerStore"],[27,28,21,80],[27,29,21,76,"seek"],[27,33,21,80],[28,4,23,2],[28,8,23,8,"controlsTimer"],[28,21,23,21],[28,24,23,24],[28,28,23,24,"useRef"],[28,41,23,30],[28,43,23,69],[28,47,23,73],[28,48,23,74],[29,4,24,2],[29,8,24,8,"fastForwardIntervalRef"],[29,30,24,30],[29,33,24,33],[29,37,24,33,"useRef"],[29,50,24,39],[29,52,24,79],[29,56,24,83],[29,57,24,84],[31,4,26,2],[32,4,27,2],[32,8,27,8,"resetTimer"],[32,18,27,18],[32,21,27,21],[32,25,27,21,"useCallback"],[32,43,27,32],[32,45,27,33],[32,57,27,39],[33,6,28,4],[34,6,29,4],[34,10,29,8,"controlsTimer"],[34,23,29,21],[34,24,29,22,"current"],[34,31,29,29],[34,33,29,31],[35,8,30,6,"clearTimeout"],[35,20,30,18],[35,21,30,19,"controlsTimer"],[35,34,30,32],[35,35,30,33,"current"],[35,42,30,40],[35,43,30,41],[36,6,31,4],[37,6,32,4],[38,6,33,4,"controlsTimer"],[38,19,33,17],[38,20,33,18,"current"],[38,27,33,25],[38,30,33,28,"setTimeout"],[38,40,33,38],[38,41,33,39],[38,53,33,45],[39,8,34,6,"setShowControls"],[39,23,34,21],[39,24,34,22],[39,29,34,27],[39,30,34,28],[40,6,35,4],[40,7,35,5],[40,9,35,7,"CONTROLS_TIMEOUT"],[40,25,35,23],[40,26,35,24],[41,4,36,2],[41,5,36,3],[41,7,36,5],[41,8,36,6,"setShowControls"],[41,23,36,21],[41,24,36,22],[41,25,36,23],[43,4,38,2],[44,4,39,2],[44,8,39,2,"useEffect"],[44,24,39,11],[44,26,39,12],[44,38,39,18],[45,6,40,4],[45,10,40,8,"showControls"],[45,22,40,20],[45,24,40,22],[46,8,41,6,"resetTimer"],[46,18,41,16],[46,19,41,17],[46,20,41,18],[47,6,42,4],[47,7,42,5],[47,13,42,11],[48,8,43,6],[49,8,44,6],[49,12,44,10,"controlsTimer"],[49,25,44,23],[49,26,44,24,"current"],[49,33,44,31],[49,35,44,33],[50,10,45,8,"clearTimeout"],[50,22,45,20],[50,23,45,21,"controlsTimer"],[50,36,45,34],[50,37,45,35,"current"],[50,44,45,42],[50,45,45,43],[51,8,46,6],[52,6,47,4],[54,6,49,4],[55,6,50,4],[55,13,50,11],[55,25,50,17],[56,8,51,6],[56,12,51,10,"controlsTimer"],[56,25,51,23],[56,26,51,24,"current"],[56,33,51,31],[56,35,51,33],[57,10,52,8,"clearTimeout"],[57,22,52,20],[57,23,52,21,"controlsTimer"],[57,36,52,34],[57,37,52,35,"current"],[57,44,52,42],[57,45,52,43],[58,8,53,6],[59,6,54,4],[59,7,54,5],[60,4,55,2],[60,5,55,3],[60,7,55,5],[60,8,55,6,"showControls"],[60,20,55,18],[60,22,55,20,"resetTimer"],[60,32,55,30],[60,33,55,31],[60,34,55,32],[62,4,57,2],[63,4,58,2],[63,8,58,2,"useEffect"],[63,24,58,11],[63,26,58,12],[63,38,58,18],[64,6,59,4],[64,13,59,11],[64,25,59,17],[65,8,60,6],[65,12,60,10,"fastForwardIntervalRef"],[65,34,60,32],[65,35,60,33,"current"],[65,42,60,40],[65,44,60,42],[66,10,61,8,"clearInterval"],[66,23,61,21],[66,24,61,22,"fastForwardIntervalRef"],[66,46,61,44],[66,47,61,45,"current"],[66,54,61,52],[66,55,61,53],[67,8,62,6],[68,6,63,4],[68,7,63,5],[69,4,64,2],[69,5,64,3],[69,7,64,5],[69,9,64,7],[69,10,64,8],[71,4,66,2],[72,4,67,2],[72,8,67,8,"handleTVEvent"],[72,21,67,21],[72,24,67,24],[72,28,67,24,"useCallback"],[72,46,67,35],[72,48,68,4],[72,58,68,5,"event"],[72,63,68,23],[72,65,68,28],[73,6,69,6],[73,10,69,10,"showEpisodeModal"],[73,26,69,26],[73,28,69,28],[74,8,70,8],[75,6,71,6],[76,6,73,6],[76,10,73,10,"event"],[76,15,73,15],[76,16,73,16,"eventType"],[76,25,73,25],[76,30,73,30],[76,41,73,41],[76,45,73,45,"event"],[76,50,73,50],[76,51,73,51,"eventType"],[76,60,73,60],[76,65,73,65],[76,75,73,75],[76,77,73,77],[77,8,74,8],[77,12,74,12,"event"],[77,17,74,17],[77,18,74,18,"eventKeyAction"],[77,32,74,32],[77,37,74,37],[77,38,74,38],[77,40,74,40],[78,10,75,10],[78,14,75,14,"fastForwardIntervalRef"],[78,36,75,36],[78,37,75,37,"current"],[78,44,75,44],[78,46,75,46],[79,12,76,12,"clearInterval"],[79,25,76,25],[79,26,76,26,"fastForwardIntervalRef"],[79,48,76,48],[79,49,76,49,"current"],[79,56,76,56],[79,57,76,57],[80,12,77,12,"fastForwardIntervalRef"],[80,34,77,34],[80,35,77,35,"current"],[80,42,77,42],[80,45,77,45],[80,49,77,49],[81,10,78,10],[82,8,79,8],[83,6,80,6],[84,6,82,6,"resetTimer"],[84,16,82,16],[84,17,82,17],[84,18,82,18],[85,6,84,6],[85,10,84,10,"showControls"],[85,22,84,22],[85,24,84,24],[86,8,85,8],[87,8,86,8],[88,8,87,8],[89,6,88,6],[90,6,90,6],[90,14,90,14,"event"],[90,19,90,19],[90,20,90,20,"eventType"],[90,29,90,29],[91,8,91,8],[91,13,91,13],[91,21,91,21],[92,10,92,10,"togglePlayPause"],[92,25,92,25],[92,26,92,26],[92,27,92,27],[93,10,93,10,"setShowControls"],[93,25,93,25],[93,26,93,26],[93,30,93,30],[93,31,93,31],[94,10,94,10],[95,8,95,8],[95,13,95,13],[95,19,95,19],[96,10,96,10,"seek"],[96,14,96,14],[96,21,96,25],[96,22,96,26],[96,23,96,27],[96,24,96,28],[97,10,97,10],[98,8,98,8],[98,13,98,13],[98,23,98,23],[99,10,99,10],[99,14,99,14],[99,15,99,15,"fastForwardIntervalRef"],[99,37,99,37],[99,38,99,38,"current"],[99,45,99,45],[99,49,99,49,"event"],[99,54,99,54],[99,55,99,55,"eventKeyAction"],[99,69,99,69],[99,74,99,74],[99,75,99,75],[99,77,99,77],[100,12,100,12,"fastForwardIntervalRef"],[100,34,100,34],[100,35,100,35,"current"],[100,42,100,42],[100,45,100,45,"setInterval"],[100,56,100,56],[100,57,100,57],[100,69,100,63],[101,14,101,14,"seek"],[101,18,101,18],[101,25,101,29],[101,26,101,30],[102,12,102,12],[102,13,102,13],[102,15,102,15],[102,18,102,18],[102,19,102,19],[103,10,103,10],[104,10,104,10],[105,8,105,8],[105,13,105,13],[105,20,105,20],[106,10,106,10,"seek"],[106,14,106,14],[106,15,106,15,"SEEK_STEP"],[106,24,106,24],[106,25,106,25],[107,10,107,10],[108,8,108,8],[108,13,108,13],[108,24,108,24],[109,10,109,10],[110,10,110,10],[110,14,110,14],[110,15,110,15,"fastForwardIntervalRef"],[110,37,110,37],[110,38,110,38,"current"],[110,45,110,45],[110,49,110,49,"event"],[110,54,110,54],[110,55,110,55,"eventKeyAction"],[110,69,110,69],[110,74,110,74],[110,75,110,75],[110,77,110,77],[111,12,111,12,"fastForwardIntervalRef"],[111,34,111,34],[111,35,111,35,"current"],[111,42,111,42],[111,45,111,45,"setInterval"],[111,56,111,56],[111,57,111,57],[111,69,111,63],[112,14,112,14,"seek"],[112,18,112,18],[112,19,112,19,"SEEK_STEP"],[112,28,112,28],[112,29,112,29],[113,12,113,12],[113,13,113,13],[113,15,113,15],[113,18,113,18],[113,19,113,19],[114,10,114,10],[115,10,115,10],[116,8,116,8],[116,13,116,13],[116,19,116,19],[117,10,117,10,"setShowControls"],[117,25,117,25],[117,26,117,26],[117,30,117,30],[117,31,117,31],[118,10,118,10],[119,6,119,6],[120,4,120,4],[120,5,120,5],[120,7,121,4],[120,8,121,5,"showControls"],[120,20,121,17],[120,22,121,19,"showEpisodeModal"],[120,38,121,35],[120,40,121,37,"setShowControls"],[120,55,121,52],[120,57,121,54,"resetTimer"],[120,67,121,64],[120,69,121,66,"togglePlayPause"],[120,84,121,81],[120,86,121,83,"seek"],[120,90,121,87],[120,91,122,2],[120,92,122,3],[122,4,124,2],[123,4,125,2],[123,8,125,2,"useTVEventHandler"],[123,38,125,19],[123,40,125,20,"handleTVEvent"],[123,53,125,40],[123,54,125,41],[125,4,127,2],[126,4,128,2],[126,8,128,8,"onScreenPress"],[126,21,128,21],[126,24,128,24],[126,33,128,24,"onScreenPress"],[126,34,128,24],[126,36,128,30],[127,6,129,4],[128,6,130,4],[128,10,130,10,"newShowControls"],[128,25,130,25],[128,28,130,28],[128,29,130,29,"showControls"],[128,41,130,41],[129,6,131,4,"setShowControls"],[129,21,131,19],[129,22,131,20,"newShowControls"],[129,37,131,35],[129,38,131,36],[131,6,133,4],[132,6,134,4],[132,10,134,8,"newShowControls"],[132,25,134,23],[132,27,134,25],[133,8,135,6,"resetTimer"],[133,18,135,16],[133,19,135,17],[133,20,135,18],[134,6,136,4],[135,4,137,2],[135,5,137,3],[136,4,139,2],[136,11,139,9],[137,6,139,11,"onScreenPress"],[138,4,139,25],[138,5,139,26],[139,2,140,0],[139,3,140,1],[140,2,140,2,"exports"],[140,9,140,2],[140,10,140,2,"useTVRemoteHandler"],[140,28,140,2],[140,31,140,2,"useTVRemoteHandler"],[140,49,140,2],[141,0,140,2]],"functionMap":{"names":["<global>","useTVRemoteHandler","resetTimer","setTimeout$argument_0","useEffect$argument_0","<anonymous>","handleTVEvent","setInterval$argument_0","onScreenPress"],"mappings":"AAA;kCCmB;iCCO;uCCM;KDE;GDC;YGG;WCW;KDI;GHC;YGG;WCC;KDI;GHC;IKI;yDCgC;aDE;yDCS;aDE;KLO;wBOQ;GPS;CDG"}},"type":"js/module"}]}