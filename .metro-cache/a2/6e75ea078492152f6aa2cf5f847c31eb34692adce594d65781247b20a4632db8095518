{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":81,"column":0,"index":2658}}],"key":"7kvm5yrOpz4NYiDi6sn4qxa8DVQ="}},{"name":"../utils/Logger","data":{"asyncType":null,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":37,"index":37}}],"key":"rD5UrWJd899SO1d///YpsfF5nbE="}}],"output":[{"data":{"code":"__d(function(g,r,i,a,m,e,d){var o=r(d[0]);Object.defineProperty(e,\"__esModule\",{value:!0}),e.getResolutionFromM3U8=void 0;const t=o(r(d[1])).default.withTag('M3U8'),n={};e.getResolutionFromM3U8=async(o,s)=>{const c=performance.now();t.info(`[PERF] M3U8 resolution detection START - url: ${o.substring(0,100)}...`);const l=n[o];if(l&&Date.now()-l.timestamp<3e5){const o=performance.now();return t.info(`[PERF] M3U8 resolution detection CACHED - took ${(o-c).toFixed(2)}ms, resolution: ${l.resolution}`),l.resolution}if(!o.toLowerCase().endsWith(\".m3u8\"))return t.info(\"[PERF] M3U8 resolution detection SKIPPED - not M3U8 file\"),null;try{const l=performance.now(),u=await fetch(o,{signal:s}),f=performance.now();if(t.info(`[PERF] M3U8 fetch took ${(f-l).toFixed(2)}ms, status: ${u.status}`),!u.ok)return null;const p=performance.now(),E=(await u.text()).split(\"\\n\");let F=0,R=null;for(const o of E)if(o.startsWith(\"#EXT-X-STREAM-INF\")){const t=o.match(/RESOLUTION=(\\d+)x(\\d+)/);if(t){const o=parseInt(t[2],10);o>F&&(F=o,R=`${o}p`)}}const w=performance.now();t.info(`[PERF] M3U8 parsing took ${(w-p).toFixed(2)}ms, lines: ${E.length}`),n[o]={resolution:R,timestamp:Date.now()};const M=performance.now();return t.info(`[PERF] M3U8 resolution detection COMPLETE - took ${(M-c).toFixed(2)}ms, resolution: ${R}`),R}catch(o){const n=performance.now();return t.info(`[PERF] M3U8 resolution detection ERROR - took ${(n-c).toFixed(2)}ms, error: ${o}`),null}}});","lineCount":1,"map":[[1,122,3,0],[1,128,3,6,"logger"],[1,130,1,0,"_interopRequireDefault"],[1,132,1,0,"r"],[1,134,1,0,"d"],[1,136,1,0],[1,141,3,15,"Logger"],[1,149,3,22,"withTag"],[1,157,3,30],[1,165,10,6,"resolutionCache"],[1,167,10,55],[1,168,10,56],[1,170,80,2,"e"],[1,172,80,2,"getResolutionFromM3U8"],[1,194,13,37,"async"],[1,200,14,2,"url"],[1,202,15,2,"signal"],[1,207,17,2],[1,213,17,8,"perfStart"],[1,215,17,20,"performance"],[1,227,17,32,"now"],[1,233,18,2,"logger"],[1,235,18,9,"info"],[1,240,18,14],[1,289,18,63,"url"],[1,291,18,67,"substring"],[1,301,18,77],[1,303,18,80],[1,314,21,2],[1,320,21,8,"cachedEntry"],[1,322,21,22,"resolutionCache"],[1,324,21,38,"url"],[1,327,22,2],[1,330,22,6,"cachedEntry"],[1,333,22,21,"Date"],[1,338,22,26,"now"],[1,344,22,34,"cachedEntry"],[1,346,22,46,"timestamp"],[1,356,11,20],[1,360,22,74],[1,361,23,4],[1,367,23,10,"perfEnd"],[1,369,23,20,"performance"],[1,381,23,32,"now"],[1,387,25,4],[1,394,24,4,"logger"],[1,396,24,11,"info"],[1,401,24,16],[1,452,24,67,"perfEnd"],[1,454,24,77,"perfStart"],[1,457,24,88,"toFixed"],[1,465,24,96],[1,486,24,117,"cachedEntry"],[1,488,24,129,"resolution"],[1,502,25,11,"cachedEntry"],[1,504,25,23,"resolution"],[1,514,26,2],[1,515,28,2],[1,519,28,7,"url"],[1,521,28,11,"toLowerCase"],[1,535,28,25,"endsWith"],[1,544,28,34],[1,553,30,4],[1,560,29,4,"logger"],[1,562,29,11,"info"],[1,567,29,16],[1,627,30,11],[1,632,33,2],[1,636,34,4],[1,642,34,10,"fetchStart"],[1,644,34,23,"performance"],[1,656,34,35,"now"],[1,662,35,10,"response"],[1,670,35,27,"fetch"],[1,676,35,33,"url"],[1,678,35,38],[1,679,35,40,"signal"],[1,690,36,10,"fetchEnd"],[1,692,36,21,"performance"],[1,704,36,33,"now"],[1,710,39,4],[1,713,37,4,"logger"],[1,715,37,11,"info"],[1,720,37,16],[1,747,37,43,"fetchEnd"],[1,749,37,54,"fetchStart"],[1,752,37,66,"toFixed"],[1,760,37,74],[1,777,37,91,"response"],[1,779,37,100,"status"],[1,790,39,9,"response"],[1,792,39,18,"ok"],[1,795,40,6],[1,802,40,13],[1,807,43,4],[1,813,43,10,"parseStart"],[1,815,43,23,"performance"],[1,827,43,35,"now"],[1,833,45,10,"lines"],[1,842,44,27,"response"],[1,844,44,36,"text"],[1,852,45,27,"split"],[1,858,45,33],[1,864,46,4],[1,868,46,8,"highestResolution"],[1,870,46,28],[1,872,47,8,"resolutionString"],[1,874,47,42],[1,879,49,4],[1,883,49,9],[1,889,49,15,"line"],[1,894,49,23,"lines"],[1,896,50,6],[1,899,50,10,"line"],[1,901,50,15,"startsWith"],[1,912,50,26],[1,933,50,48],[1,934,51,8],[1,940,51,14,"resolutionMatch"],[1,942,51,32,"line"],[1,944,51,37,"match"],[1,950,51,43],[1,976,52,8],[1,979,52,12,"resolutionMatch"],[1,981,52,29],[1,982,53,10],[1,988,53,16,"height"],[1,990,53,25,"parseInt"],[1,999,53,34,"resolutionMatch"],[1,1001,53,50],[1,1004,53,54],[1,1008,54,14,"height"],[1,1010,54,23,"highestResolution"],[1,1014,55,12,"highestResolution"],[1,1016,55,32,"height"],[1,1018,56,12,"resolutionString"],[1,1020,56,31],[1,1023,56,34,"height"],[1,1028,58,8],[1,1029,59,6],[1,1030,62,4],[1,1036,62,10,"parseEnd"],[1,1038,62,21,"performance"],[1,1050,62,33,"now"],[1,1056,63,4,"logger"],[1,1058,63,11,"info"],[1,1063,63,16],[1,1092,63,45,"parseEnd"],[1,1094,63,56,"parseStart"],[1,1097,63,68,"toFixed"],[1,1105,63,76],[1,1121,63,92,"lines"],[1,1123,63,98,"length"],[1,1133,66,4,"resolutionCache"],[1,1135,66,20,"url"],[1,1138,66,27],[1,1139,67,6,"resolution"],[1,1150,67,18,"resolutionString"],[1,1152,68,6,"timestamp"],[1,1162,68,17,"Date"],[1,1167,68,22,"now"],[1,1174,71,4],[1,1180,71,10,"perfEnd"],[1,1182,71,20,"performance"],[1,1194,71,32,"now"],[1,1200,74,4],[1,1207,72,4,"logger"],[1,1209,72,11,"info"],[1,1214,72,16],[1,1267,72,69,"perfEnd"],[1,1269,72,79,"perfStart"],[1,1272,72,90,"toFixed"],[1,1280,72,98],[1,1301,72,119,"resolutionString"],[1,1306,74,11,"resolutionString"],[1,1307,75,2],[1,1308,75,4],[1,1314,75,11,"error"],[1,1317,76,4],[1,1323,76,10,"perfEnd"],[1,1325,76,20,"performance"],[1,1337,76,32,"now"],[1,1343,78,4],[1,1350,77,4,"logger"],[1,1352,77,11,"info"],[1,1357,77,16],[1,1407,77,66,"perfEnd"],[1,1409,77,76,"perfStart"],[1,1412,77,87,"toFixed"],[1,1420,77,95],[1,1436,77,111,"error"],[1,1441,78,11],[1,1445,79,2],[1,1447,80,2]],"functionMap":{"names":["<global>","getResolutionFromM3U8"],"mappings":"AAA;qCCY;CDmE"}},"type":"js/module"}]}