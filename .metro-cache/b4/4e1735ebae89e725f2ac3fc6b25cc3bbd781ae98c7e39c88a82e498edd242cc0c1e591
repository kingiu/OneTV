{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":276,"column":29,"index":8000}}],"key":"7kvm5yrOpz4NYiDi6sn4qxa8DVQ="}},{"name":"react-native-web/dist/exports/Platform","data":{"asyncType":null,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":276,"column":29,"index":8000}}],"key":"jM/HC84YZkM9kLoiCo0Bpf0Xr+w="}},{"name":"@react-native-community/netinfo","data":{"asyncType":null,"locs":[{"start":{"line":5,"column":0,"index":131},"end":{"line":5,"column":54,"index":185}}],"key":"ltLFhIfxyy89okchfB5w/bUar/s="}},{"name":"../utils/Logger","data":{"asyncType":null,"locs":[{"start":{"line":6,"column":0,"index":186},"end":{"line":6,"column":37,"index":223}}],"key":"rD5UrWJd899SO1d///YpsfF5nbE="}},{"name":"react-native-tcp-socket","data":{"asyncType":null,"locs":[{"start":{"line":4,"column":18,"index":95},"end":{"line":4,"column":52,"index":129}}],"key":"+ssIBgrWlZntZU4FFeZIHyf1XWA="}}],"output":[{"data":{"code":"__d(function(g,r,_i,a,m,e,d){var t=r(d[0]);Object.defineProperty(e,\"__esModule\",{value:!0}),e.default=void 0;t(r(d[1]));var n=t(r(d[2])),s=t(r(d[3]));r(d[4]);const o=s.default.withTag('TCPHttpServer');e.default=class{server=null;isRunning=!1;requestHandler=null;constructor(){this.server=null}parseHttpRequest(t){try{const n=t.split('\\r\\n'),s=n[0].split(' ');if(s.length<3)return null;const o=s[0],i=s[1],l={};let u=-1;for(let t=1;t<n.length;t++){const s=n[t];if(''===s){u=t+1;break}const o=s.indexOf(':');if(o>0){const t=s.substring(0,o).trim().toLowerCase(),n=s.substring(o+1).trim();l[t]=n}}return{method:o,url:i,headers:l,body:u>0?n.slice(u).join('\\r\\n'):''}}catch(t){return o.info('[TCPHttpServer] Error parsing HTTP request:',t),null}}formatHttpResponse(t){const n={200:'OK',400:'Bad Request',404:'Not Found',500:'Internal Server Error'}[t.statusCode]||'Unknown',s=Object.assign({'Content-Length':(new TextEncoder).encode(t.body||'').length.toString(),Connection:'close'},t.headers);let o=`HTTP/1.1 ${t.statusCode} ${n}\\r\\n`;for(const[t,n]of Object.entries(s))o+=`${t}: ${n}\\r\\n`;return o+='\\r\\n',o+=t.body||'',o}handleConnection(t){o.debug('[TCPHttpServer] Client connected');let n='';t.on('data',async s=>{if(n+=s.toString(),n.includes('\\r\\n\\r\\n')){try{const s=this.parseHttpRequest(n);if(s&&this.requestHandler){const n=await this.requestHandler(s),o=this.formatHttpResponse(n);t.write(o)}else{const n=this.formatHttpResponse({statusCode:400,headers:{'Content-Type':'text/plain'},body:'Bad Request'});t.write(n)}}catch(n){o.info('[TCPHttpServer] Error handling request:',n);const s=this.formatHttpResponse({statusCode:500,headers:{'Content-Type':'text/plain'},body:'Internal Server Error'});t.write(s)}t.end(),n=''}}),t.on('error',t=>{o.info('[TCPHttpServer] Socket error:',t)}),t.on('close',()=>{o.debug('[TCPHttpServer] Client disconnected')})}setRequestHandler(t){this.requestHandler=t}async start(){if(this.server&&!this.isRunning){try{this.server.close(),o.debug('[TCPHttpServer] Old server instance closed')}catch(t){o.info('[TCPHttpServer] Error closing old server:',t)}this.server=null}const t=await n.default.fetch();let s=null;if('wifi'!==t.type&&'ethernet'!==t.type||(s=t.details?.ipAddress??null),!s)throw new Error('\\u65e0\\u6cd5\\u83b7\\u53d6IP\\u5730\\u5740\\uff0c\\u8bf7\\u786e\\u8ba4\\u8bbe\\u5907\\u5df2\\u8fde\\u63a5\\u5230WiFi\\u6216\\u4ee5\\u592a\\u7f51\\u3002');if(this.isRunning)return o.debug('[TCPHttpServer] Server is already running.'),`http://${s}:12346`;throw o.error('[TCPHttpServer] TCP server not supported on web platform'),new Error('Web\\u5e73\\u53f0\\u4e0d\\u652f\\u6301TCP\\u670d\\u52a1\\u5668')}stop(){try{this.server&&(this.server.close(),o.debug('[TCPHttpServer] Server stopped'))}catch(t){o.info('[TCPHttpServer] Error stopping server:',t)}finally{this.isRunning=!1,this.server=null}}getIsRunning(){return this.isRunning}}});","lineCount":1,"map":[[1,124,5,0,"_netinfo"],[1,126,5,0,"_interopRequireDefault"],[1,128,5,0,"r"],[1,130,5,0,"d"],[1,132,5,0],[1,137,6,0,"_Logger"],[1,139,6,0,"_interopRequireDefault"],[1,141,6,0,"r"],[1,143,6,0,"d"],[1,145,6,0],[1,150,4,18,"require"],[1,152,4,25,"d"],[1,154,4,25],[1,158,4,0],[1,164,8,6,"logger"],[1,166,8,15,"Logger"],[1,176,8,22,"withTag"],[1,184,8,30],[1,201,274,1,"e"],[1,203,274,1,"default"],[1,211,27,0],[1,217,28,10,"server"],[1,224,28,31],[1,229,29,10,"isRunning"],[1,240,29,22],[1,242,30,10,"requestHandler"],[1,257,30,50],[1,262,32,2,"constructor"],[1,276,33,4,"this"],[1,281,33,9,"server"],[1,288,33,18],[1,292,34,2],[1,293,36,10,"parseHttpRequest"],[1,310,36,27,"data"],[1,313,37,4],[1,317,38,6],[1,323,38,12,"lines"],[1,325,38,20,"data"],[1,327,38,25,"split"],[1,333,38,31],[1,341,39,12,"requestLine"],[1,343,39,26,"lines"],[1,345,39,32],[1,348,39,35,"split"],[1,354,39,41],[1,359,41,6],[1,362,41,10,"requestLine"],[1,364,41,22,"length"],[1,371,41,31],[1,373,42,8],[1,380,42,15],[1,385,45,6],[1,391,45,12,"method"],[1,393,45,21,"requestLine"],[1,395,45,33],[1,398,46,12,"url"],[1,400,46,18,"requestLine"],[1,402,46,30],[1,405,47,12,"headers"],[1,407,47,46],[1,408,47,47],[1,410,49,6],[1,414,49,10,"bodyStartIndex"],[1,417,49,24],[1,419,50,6],[1,423,50,11],[1,427,50,15,"i"],[1,429,50,19],[1,431,50,22,"i"],[1,433,50,26,"lines"],[1,435,50,32,"length"],[1,442,50,40,"i"],[1,446,50,45],[1,447,51,8],[1,453,51,14,"line"],[1,455,51,21,"lines"],[1,457,51,27,"i"],[1,460,52,8],[1,463,52,21],[1,468,52,12,"line"],[1,470,52,25],[1,471,53,10,"bodyStartIndex"],[1,473,53,27,"i"],[1,475,53,31],[1,477,54,10],[1,482,55,8],[1,483,56,8],[1,489,56,14,"colonIndex"],[1,491,56,27,"line"],[1,493,56,32,"indexOf"],[1,501,56,40],[1,506,57,8],[1,509,57,12,"colonIndex"],[1,511,57,25],[1,513,57,28],[1,514,58,10],[1,520,58,16,"key"],[1,522,58,22,"line"],[1,524,58,27,"substring"],[1,534,58,37],[1,536,58,40,"colonIndex"],[1,539,58,52,"trim"],[1,546,58,59,"toLowerCase"],[1,560,59,16,"value"],[1,562,59,24,"line"],[1,564,59,29,"substring"],[1,574,59,39,"colonIndex"],[1,576,59,52],[1,579,59,55,"trim"],[1,586,60,10,"headers"],[1,588,60,18,"key"],[1,591,60,25,"value"],[1,592,61,8],[1,593,62,6],[1,594,66,6],[1,600,66,13],[1,601,66,15,"method"],[1,610,66,23,"url"],[1,616,66,28,"headers"],[1,626,66,37,"body"],[1,631,64,19,"bodyStartIndex"],[1,633,64,36],[1,635,64,40,"lines"],[1,637,64,46,"slice"],[1,643,64,52,"bodyStartIndex"],[1,646,64,68,"join"],[1,651,64,73],[1,659,64,83],[1,662,67,4],[1,663,67,6],[1,669,67,13,"error"],[1,672,69,6],[1,679,68,6,"logger"],[1,681,68,13,"info"],[1,686,68,18],[1,732,68,65,"error"],[1,735,69,13],[1,739,70,4],[1,740,71,2],[1,741,73,10,"formatHttpResponse"],[1,760,73,29,"response"],[1,763,74,4],[1,769,81,10,"statusText"],[1,771,74,48],[1,772,75,6],[1,776,75,11],[1,781,76,6],[1,785,76,11],[1,799,77,6],[1,803,77,11],[1,815,78,6],[1,819,78,11],[1,844,81,35,"response"],[1,846,81,44,"statusCode"],[1,859,81,59],[1,869,82,10,"headers"],[1,871,82,17,"Object"],[1,878,82,17,"assign"],[1,885,82,17],[1,886,83,6],[1,904,83,24],[1,908,83,28,"TextEncoder"],[1,921,83,42,"encode"],[1,928,83,49,"response"],[1,930,83,58,"body"],[1,936,83,66],[1,940,83,70,"length"],[1,947,83,77,"toString"],[1,958,84,6,"Connection"],[1,969,84,20],[1,978,85,9,"response"],[1,980,85,18,"headers"],[1,989,88,4],[1,993,88,8,"httpResponse"],[1,995,88,23],[1,1007,88,35,"response"],[1,1009,88,44,"statusCode"],[1,1023,88,58,"statusText"],[1,1031,90,4],[1,1035,90,9],[1,1041,90,16,"key"],[1,1043,90,21,"value"],[1,1048,90,31,"Object"],[1,1055,90,38,"entries"],[1,1063,90,46,"headers"],[1,1066,91,6,"httpResponse"],[1,1069,91,22],[1,1072,91,25,"key"],[1,1078,91,33,"value"],[1,1086,97,4],[1,1093,94,4,"httpResponse"],[1,1096,94,20],[1,1103,95,4,"httpResponse"],[1,1106,95,20,"response"],[1,1108,95,29,"body"],[1,1114,95,37],[1,1117,97,11,"httpResponse"],[1,1118,98,2],[1,1119,100,10,"handleConnection"],[1,1136,100,27,"socket"],[1,1139,101,4,"logger"],[1,1141,101,11,"debug"],[1,1147,101,17],[1,1183,103,4],[1,1187,103,8,"requestData"],[1,1189,103,22],[1,1192,105,4,"socket"],[1,1194,105,11,"on"],[1,1197,105,14],[1,1204,105,22,"async"],[1,1214,109,6],[1,1217,106,6,"requestData"],[1,1220,106,21,"data"],[1,1222,106,26,"toString"],[1,1233,109,10,"requestData"],[1,1235,109,22,"includes"],[1,1244,109,31],[1,1256,109,44],[1,1257,110,8],[1,1261,111,10],[1,1267,111,16,"request"],[1,1269,111,26,"this"],[1,1274,111,31,"parseHttpRequest"],[1,1291,111,48,"requestData"],[1,1294,112,10],[1,1297,112,14,"request"],[1,1300,112,25,"this"],[1,1305,112,30,"requestHandler"],[1,1320,112,46],[1,1321,113,12],[1,1327,113,18,"response"],[1,1335,113,35,"this"],[1,1340,113,40,"requestHandler"],[1,1355,113,55,"request"],[1,1358,114,18,"httpResponse"],[1,1360,114,33,"this"],[1,1365,114,38,"formatHttpResponse"],[1,1384,114,57,"response"],[1,1387,115,12,"socket"],[1,1389,115,19,"write"],[1,1395,115,25,"httpResponse"],[1,1397,116,10],[1,1402,116,17],[1,1403,118,12],[1,1409,118,18,"errorResponse"],[1,1411,118,34,"this"],[1,1416,118,39,"formatHttpResponse"],[1,1435,118,58],[1,1436,119,14,"statusCode"],[1,1447,119,26],[1,1451,120,14,"headers"],[1,1459,120,23],[1,1460,120,25],[1,1475,120,41],[1,1489,121,14,"body"],[1,1494,121,20],[1,1510,123,12,"socket"],[1,1512,123,19,"write"],[1,1518,123,25,"errorResponse"],[1,1520,124,10],[1,1521,125,8],[1,1522,125,10],[1,1528,125,17,"error"],[1,1531,126,10,"logger"],[1,1533,126,17,"info"],[1,1538,126,22],[1,1580,126,65,"error"],[1,1583,127,10],[1,1589,127,16,"errorResponse"],[1,1591,127,32,"this"],[1,1596,127,37,"formatHttpResponse"],[1,1615,127,56],[1,1616,128,12,"statusCode"],[1,1627,128,24],[1,1631,129,12,"headers"],[1,1639,129,21],[1,1640,129,23],[1,1655,129,39],[1,1669,130,12,"body"],[1,1674,130,18],[1,1700,132,10,"socket"],[1,1702,132,17,"write"],[1,1708,132,23,"errorResponse"],[1,1710,133,8],[1,1711,135,8,"socket"],[1,1713,135,15,"end"],[1,1719,136,8,"requestData"],[1,1721,136,22],[1,1723,137,6],[1,1727,140,4,"socket"],[1,1729,140,11,"on"],[1,1732,140,14],[1,1740,140,24,"error"],[1,1744,141,6,"logger"],[1,1746,141,13,"info"],[1,1751,141,18],[1,1783,141,51,"error"],[1,1788,144,4,"socket"],[1,1790,144,11,"on"],[1,1793,144,14],[1,1801,144,23],[1,1806,145,6,"logger"],[1,1808,145,13,"debug"],[1,1814,145,19],[1,1854,147,2],[1,1855,149,9,"setRequestHandler"],[1,1873,149,27,"handler"],[1,1876,150,4,"this"],[1,1881,150,9,"requestHandler"],[1,1896,150,26,"handler"],[1,1897,151,2],[1,1898,153,2],[1,1909,153,15,"start"],[1,1912,155,4],[1,1915,155,8,"this"],[1,1920,155,13,"server"],[1,1929,155,24,"this"],[1,1934,155,29,"isRunning"],[1,1944,155,40],[1,1945,156,6],[1,1949,157,8,"this"],[1,1954,157,13,"server"],[1,1961,157,20,"close"],[1,1969,158,8,"logger"],[1,1971,158,15,"debug"],[1,1977,158,21],[1,2022,159,6],[1,2023,159,8],[1,2029,159,15,"error"],[1,2032,160,8,"logger"],[1,2034,160,15,"info"],[1,2039,160,20],[1,2083,160,65,"error"],[1,2085,161,6],[1,2086,162,6,"this"],[1,2091,162,11,"server"],[1,2098,162,20],[1,2102,163,4],[1,2103,165,4],[1,2109,165,10,"netState"],[1,2117,165,27,"NetInfo"],[1,2127,165,35,"fetch"],[1,2135,166,4],[1,2139,166,8,"ipAddress"],[1,2141,166,35],[1,2146,172,4],[1,2149,168,26],[1,2158,168,8,"netState"],[1,2160,168,17,"type"],[1,2166,168,54],[1,2179,168,36,"netState"],[1,2181,168,45,"type"],[1,2188,169,6,"ipAddress"],[1,2190,169,19,"netState"],[1,2192,169,28,"details"],[1,2201,169,45,"ipAddress"],[1,2212,169,58],[1,2219,172,9,"ipAddress"],[1,2221,173,6],[1,2227,173,12],[1,2231,173,16,"Error"],[1,2237,173,22],[1,2373,176,4],[1,2376,176,8,"this"],[1,2381,176,13,"isRunning"],[1,2391,178,6],[1,2398,177,6,"logger"],[1,2400,177,13,"debug"],[1,2406,177,19],[1,2452,178,13],[1,2462,178,23,"ipAddress"],[1,2472,184,6],[1,2478,183,6,"logger"],[1,2480,183,13,"error"],[1,2486,183,19],[1,2546,184,12],[1,2550,184,16,"Error"],[1,2556,184,22],[1,2613,255,2],[1,2614,257,9,"stop"],[1,2621,258,4],[1,2625,259,10,"this"],[1,2630,259,15,"server"],[1,2639,260,8,"this"],[1,2644,260,13,"server"],[1,2651,260,20,"close"],[1,2659,261,8,"logger"],[1,2661,261,15,"debug"],[1,2667,261,21],[1,2701,263,4],[1,2702,263,6],[1,2708,263,13,"error"],[1,2711,264,6,"logger"],[1,2713,264,13,"info"],[1,2718,264,18],[1,2759,264,60,"error"],[1,2761,265,4],[1,2762,265,5],[1,2770,266,6,"this"],[1,2775,266,11,"isRunning"],[1,2786,266,23],[1,2788,267,6,"this"],[1,2793,267,11,"server"],[1,2800,267,20],[1,2804,268,4],[1,2805,269,2],[1,2806,271,9,"getIsRunning"],[1,2821,272,4],[1,2828,272,11,"this"],[1,2833,272,16,"isRunning"],[1,2842,273,2],[1,2844,276,28]],"functionMap":{"names":["<global>","TCPHttpServer","TCPHttpServer#constructor","TCPHttpServer#parseHttpRequest","TCPHttpServer#formatHttpResponse","TCPHttpServer#handleConnection","socket.on$argument_1","TCPHttpServer#setRequestHandler","TCPHttpServer#start","Promise$argument_0","TcpSocket.createServer$argument_0","server.listen$argument_1","server.on$argument_1","TCPHttpServer#stop","TCPHttpServer#getIsRunning"],"mappings":"AAA;AC0B;ECK;GDE;EEE;GFmC;EGE;GHyB;EIE;sBCK;KDiC;uBCE;KDE;uBCE;KDE;GJC;EME;GNE;EOE;uBCkC;+CCqB;WDE;4DEuB;SFI;gCGE;SHS;KDM;GPC;EYE;GZY;EaE;GbE;CDC"}},"type":"js/module"}]}