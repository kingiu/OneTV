{"dependencies":[{"name":"react","data":{"asyncType":null,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":44,"index":44}}],"key":"a4EMkKqamYWCMMPV7UeQlqGQ+ks="}},{"name":"@/stores/settingsStore","data":{"asyncType":null,"locs":[{"start":{"line":2,"column":0,"index":45},"end":{"line":2,"column":58,"index":103}}],"key":"eV02vLtn6v4o2w8A7owZVbPhKIg="}},{"name":"@/services/api","data":{"asyncType":null,"locs":[{"start":{"line":3,"column":0,"index":104},"end":{"line":3,"column":37,"index":141}}],"key":"kVzDQdjnETfy4Hfg6zlHm9ALTDs="}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.useApiConfig = exports.getApiConfigErrorMessage = void 0;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _settingsStore = require(_dependencyMap[1], \"@/stores/settingsStore\");\n  var _api = require(_dependencyMap[2], \"@/services/api\");\n  var _s = $RefreshSig$();\n  const useApiConfig = () => {\n    _s();\n    const {\n      apiBaseUrl,\n      serverConfig,\n      isLoadingServerConfig\n    } = (0, _settingsStore.useSettingsStore)();\n    const [validationState, setValidationState] = (0, _react.useState)({\n      isValidating: false,\n      isValid: null,\n      error: null\n    });\n    const isConfigured = Boolean(apiBaseUrl && apiBaseUrl.trim());\n    const needsConfiguration = !isConfigured;\n\n    // Validate API configuration when it changes\n    (0, _react.useEffect)(() => {\n      if (!isConfigured) {\n        setValidationState({\n          isValidating: false,\n          isValid: false,\n          error: null\n        });\n        return;\n      }\n      const validateConfig = async () => {\n        setValidationState(prev => ({\n          ...prev,\n          isValidating: true,\n          error: null\n        }));\n        try {\n          await _api.api.getServerConfig();\n          setValidationState({\n            isValidating: false,\n            isValid: true,\n            error: null\n          });\n        } catch (error) {\n          let errorMessage = '服务器连接失败';\n          if (error instanceof Error) {\n            switch (error.message) {\n              case 'API_URL_NOT_SET':\n                errorMessage = 'API地址未设置';\n                break;\n              case 'UNAUTHORIZED':\n                errorMessage = '服务器认证失败';\n                break;\n              default:\n                if (error.message.includes('Network')) {\n                  errorMessage = '网络连接失败，请检查网络或服务器地址';\n                } else if (error.message.includes('timeout')) {\n                  errorMessage = '连接超时，请检查服务器地址';\n                } else if (error.message.includes('404')) {\n                  errorMessage = '服务器地址无效，请检查API路径';\n                } else if (error.message.includes('500')) {\n                  errorMessage = '服务器内部错误';\n                }\n                break;\n            }\n          }\n          setValidationState({\n            isValidating: false,\n            isValid: false,\n            error: errorMessage\n          });\n        }\n      };\n\n      // Only validate if not already loading server config\n      if (!isLoadingServerConfig) {\n        validateConfig();\n      }\n    }, [apiBaseUrl, isConfigured, isLoadingServerConfig]);\n\n    // Reset validation when server config loading state changes\n    (0, _react.useEffect)(() => {\n      if (isLoadingServerConfig) {\n        setValidationState(prev => ({\n          ...prev,\n          isValidating: true,\n          error: null\n        }));\n      }\n    }, [isLoadingServerConfig]);\n\n    // Update validation state based on server config\n    (0, _react.useEffect)(() => {\n      if (!isLoadingServerConfig && isConfigured) {\n        if (serverConfig) {\n          setValidationState(prev => ({\n            ...prev,\n            isValid: true,\n            error: null\n          }));\n        } else {\n          setValidationState(prev => ({\n            ...prev,\n            isValid: false,\n            error: prev.error || '无法获取服务器配置'\n          }));\n        }\n      }\n    }, [serverConfig, isLoadingServerConfig, isConfigured]);\n    const status = {\n      isConfigured,\n      isValidating: validationState.isValidating || isLoadingServerConfig,\n      isValid: validationState.isValid,\n      error: validationState.error,\n      needsConfiguration\n    };\n    return status;\n  };\n  exports.useApiConfig = useApiConfig;\n  _s(useApiConfig, \"taSK+pvopONN482YK7Ja3TDdukc=\", false, function () {\n    return [_settingsStore.useSettingsStore];\n  });\n  const getApiConfigErrorMessage = status => {\n    if (status.needsConfiguration) {\n      return '请点击右上角设置按钮，配置您的服务器地址';\n    }\n    if (status.error) {\n      return status.error;\n    }\n    if (status.isValidating) {\n      return '正在验证服务器配置...';\n    }\n    if (status.isValid === false) {\n      return '服务器配置验证失败，请检查设置';\n    }\n    return '加载失败，请重试';\n  };\n  exports.getApiConfigErrorMessage = getApiConfigErrorMessage;\n});","lineCount":143,"map":[[6,2,1,0],[6,6,1,0,"_react"],[6,12,1,0],[6,15,1,0,"require"],[6,22,1,0],[6,23,1,0,"_dependencyMap"],[6,37,1,0],[7,2,2,0],[7,6,2,0,"_settingsStore"],[7,20,2,0],[7,23,2,0,"require"],[7,30,2,0],[7,31,2,0,"_dependencyMap"],[7,45,2,0],[8,2,3,0],[8,6,3,0,"_api"],[8,10,3,0],[8,13,3,0,"require"],[8,20,3,0],[8,21,3,0,"_dependencyMap"],[8,35,3,0],[9,2,3,37],[9,6,3,37,"_s"],[9,8,3,37],[9,11,3,37,"$RefreshSig$"],[9,23,3,37],[10,2,13,7],[10,8,13,13,"useApiConfig"],[10,20,13,25],[10,23,13,28,"useApiConfig"],[10,24,13,28],[10,29,13,34],[11,4,13,34,"_s"],[11,6,13,34],[12,4,14,2],[12,10,14,8],[13,6,14,10,"apiBaseUrl"],[13,16,14,20],[14,6,14,22,"serverConfig"],[14,18,14,34],[15,6,14,36,"isLoadingServerConfig"],[16,4,14,58],[16,5,14,59],[16,8,14,62],[16,12,14,62,"useSettingsStore"],[16,43,14,78],[16,45,14,79],[16,46,14,80],[17,4,15,2],[17,10,15,8],[17,11,15,9,"validationState"],[17,26,15,24],[17,28,15,26,"setValidationState"],[17,46,15,44],[17,47,15,45],[17,50,15,48],[17,54,15,48,"useState"],[17,69,15,56],[17,71,19,5],[18,6,20,4,"isValidating"],[18,18,20,16],[18,20,20,18],[18,25,20,23],[19,6,21,4,"isValid"],[19,13,21,11],[19,15,21,13],[19,19,21,17],[20,6,22,4,"error"],[20,11,22,9],[20,13,22,11],[21,4,23,2],[21,5,23,3],[21,6,23,4],[22,4,25,2],[22,10,25,8,"isConfigured"],[22,22,25,20],[22,25,25,23,"Boolean"],[22,32,25,30],[22,33,25,31,"apiBaseUrl"],[22,43,25,41],[22,47,25,45,"apiBaseUrl"],[22,57,25,55],[22,58,25,56,"trim"],[22,62,25,60],[22,63,25,61],[22,64,25,62],[22,65,25,63],[23,4,26,2],[23,10,26,8,"needsConfiguration"],[23,28,26,26],[23,31,26,29],[23,32,26,30,"isConfigured"],[23,44,26,42],[25,4,28,2],[26,4,29,2],[26,8,29,2,"useEffect"],[26,24,29,11],[26,26,29,12],[26,32,29,18],[27,6,30,4],[27,10,30,8],[27,11,30,9,"isConfigured"],[27,23,30,21],[27,25,30,23],[28,8,31,6,"setValidationState"],[28,26,31,24],[28,27,31,25],[29,10,32,8,"isValidating"],[29,22,32,20],[29,24,32,22],[29,29,32,27],[30,10,33,8,"isValid"],[30,17,33,15],[30,19,33,17],[30,24,33,22],[31,10,34,8,"error"],[31,15,34,13],[31,17,34,15],[32,8,35,6],[32,9,35,7],[32,10,35,8],[33,8,36,6],[34,6,37,4],[35,6,39,4],[35,12,39,10,"validateConfig"],[35,26,39,24],[35,29,39,27],[35,35,39,27,"validateConfig"],[35,36,39,27],[35,41,39,39],[36,8,40,6,"setValidationState"],[36,26,40,24],[36,27,40,25,"prev"],[36,31,40,29],[36,36,40,34],[37,10,40,36],[37,13,40,39,"prev"],[37,17,40,43],[38,10,40,45,"isValidating"],[38,22,40,57],[38,24,40,59],[38,28,40,63],[39,10,40,65,"error"],[39,15,40,70],[39,17,40,72],[40,8,40,77],[40,9,40,78],[40,10,40,79],[40,11,40,80],[41,8,42,6],[41,12,42,10],[42,10,43,8],[42,16,43,14,"api"],[42,24,43,17],[42,25,43,18,"getServerConfig"],[42,40,43,33],[42,41,43,34],[42,42,43,35],[43,10,44,8,"setValidationState"],[43,28,44,26],[43,29,44,27],[44,12,45,10,"isValidating"],[44,24,45,22],[44,26,45,24],[44,31,45,29],[45,12,46,10,"isValid"],[45,19,46,17],[45,21,46,19],[45,25,46,23],[46,12,47,10,"error"],[46,17,47,15],[46,19,47,17],[47,10,48,8],[47,11,48,9],[47,12,48,10],[48,8,49,6],[48,9,49,7],[48,10,49,8],[48,17,49,15,"error"],[48,22,49,20],[48,24,49,22],[49,10,50,8],[49,14,50,12,"errorMessage"],[49,26,50,24],[49,29,50,27],[49,38,50,36],[50,10,52,8],[50,14,52,12,"error"],[50,19,52,17],[50,31,52,29,"Error"],[50,36,52,34],[50,38,52,36],[51,12,53,10],[51,20,53,18,"error"],[51,25,53,23],[51,26,53,24,"message"],[51,33,53,31],[52,14,54,12],[52,19,54,17],[52,36,54,34],[53,16,55,14,"errorMessage"],[53,28,55,26],[53,31,55,29],[53,41,55,39],[54,16,56,14],[55,14,57,12],[55,19,57,17],[55,33,57,31],[56,16,58,14,"errorMessage"],[56,28,58,26],[56,31,58,29],[56,40,58,38],[57,16,59,14],[58,14,60,12],[59,16,61,14],[59,20,61,18,"error"],[59,25,61,23],[59,26,61,24,"message"],[59,33,61,31],[59,34,61,32,"includes"],[59,42,61,40],[59,43,61,41],[59,52,61,50],[59,53,61,51],[59,55,61,53],[60,18,62,16,"errorMessage"],[60,30,62,28],[60,33,62,31],[60,53,62,51],[61,16,63,14],[61,17,63,15],[61,23,63,21],[61,27,63,25,"error"],[61,32,63,30],[61,33,63,31,"message"],[61,40,63,38],[61,41,63,39,"includes"],[61,49,63,47],[61,50,63,48],[61,59,63,57],[61,60,63,58],[61,62,63,60],[62,18,64,16,"errorMessage"],[62,30,64,28],[62,33,64,31],[62,48,64,46],[63,16,65,14],[63,17,65,15],[63,23,65,21],[63,27,65,25,"error"],[63,32,65,30],[63,33,65,31,"message"],[63,40,65,38],[63,41,65,39,"includes"],[63,49,65,47],[63,50,65,48],[63,55,65,53],[63,56,65,54],[63,58,65,56],[64,18,66,16,"errorMessage"],[64,30,66,28],[64,33,66,31],[64,51,66,49],[65,16,67,14],[65,17,67,15],[65,23,67,21],[65,27,67,25,"error"],[65,32,67,30],[65,33,67,31,"message"],[65,40,67,38],[65,41,67,39,"includes"],[65,49,67,47],[65,50,67,48],[65,55,67,53],[65,56,67,54],[65,58,67,56],[66,18,68,16,"errorMessage"],[66,30,68,28],[66,33,68,31],[66,42,68,40],[67,16,69,14],[68,16,70,14],[69,12,71,10],[70,10,72,8],[71,10,74,8,"setValidationState"],[71,28,74,26],[71,29,74,27],[72,12,75,10,"isValidating"],[72,24,75,22],[72,26,75,24],[72,31,75,29],[73,12,76,10,"isValid"],[73,19,76,17],[73,21,76,19],[73,26,76,24],[74,12,77,10,"error"],[74,17,77,15],[74,19,77,17,"errorMessage"],[75,10,78,8],[75,11,78,9],[75,12,78,10],[76,8,79,6],[77,6,80,4],[77,7,80,5],[79,6,82,4],[80,6,83,4],[80,10,83,8],[80,11,83,9,"isLoadingServerConfig"],[80,32,83,30],[80,34,83,32],[81,8,84,6,"validateConfig"],[81,22,84,20],[81,23,84,21],[81,24,84,22],[82,6,85,4],[83,4,86,2],[83,5,86,3],[83,7,86,5],[83,8,86,6,"apiBaseUrl"],[83,18,86,16],[83,20,86,18,"isConfigured"],[83,32,86,30],[83,34,86,32,"isLoadingServerConfig"],[83,55,86,53],[83,56,86,54],[83,57,86,55],[85,4,88,2],[86,4,89,2],[86,8,89,2,"useEffect"],[86,24,89,11],[86,26,89,12],[86,32,89,18],[87,6,90,4],[87,10,90,8,"isLoadingServerConfig"],[87,31,90,29],[87,33,90,31],[88,8,91,6,"setValidationState"],[88,26,91,24],[88,27,91,25,"prev"],[88,31,91,29],[88,36,91,34],[89,10,91,36],[89,13,91,39,"prev"],[89,17,91,43],[90,10,91,45,"isValidating"],[90,22,91,57],[90,24,91,59],[90,28,91,63],[91,10,91,65,"error"],[91,15,91,70],[91,17,91,72],[92,8,91,77],[92,9,91,78],[92,10,91,79],[92,11,91,80],[93,6,92,4],[94,4,93,2],[94,5,93,3],[94,7,93,5],[94,8,93,6,"isLoadingServerConfig"],[94,29,93,27],[94,30,93,28],[94,31,93,29],[96,4,95,2],[97,4,96,2],[97,8,96,2,"useEffect"],[97,24,96,11],[97,26,96,12],[97,32,96,18],[98,6,97,4],[98,10,97,8],[98,11,97,9,"isLoadingServerConfig"],[98,32,97,30],[98,36,97,34,"isConfigured"],[98,48,97,46],[98,50,97,48],[99,8,98,6],[99,12,98,10,"serverConfig"],[99,24,98,22],[99,26,98,24],[100,10,99,8,"setValidationState"],[100,28,99,26],[100,29,99,27,"prev"],[100,33,99,31],[100,38,99,36],[101,12,99,38],[101,15,99,41,"prev"],[101,19,99,45],[102,12,99,47,"isValid"],[102,19,99,54],[102,21,99,56],[102,25,99,60],[103,12,99,62,"error"],[103,17,99,67],[103,19,99,69],[104,10,99,74],[104,11,99,75],[104,12,99,76],[104,13,99,77],[105,8,100,6],[105,9,100,7],[105,15,100,13],[106,10,101,8,"setValidationState"],[106,28,101,26],[106,29,101,27,"prev"],[106,33,101,31],[106,38,101,36],[107,12,102,10],[107,15,102,13,"prev"],[107,19,102,17],[108,12,103,10,"isValid"],[108,19,103,17],[108,21,103,19],[108,26,103,24],[109,12,104,10,"error"],[109,17,104,15],[109,19,104,17,"prev"],[109,23,104,21],[109,24,104,22,"error"],[109,29,104,27],[109,33,104,31],[110,10,105,8],[110,11,105,9],[110,12,105,10],[110,13,105,11],[111,8,106,6],[112,6,107,4],[113,4,108,2],[113,5,108,3],[113,7,108,5],[113,8,108,6,"serverConfig"],[113,20,108,18],[113,22,108,20,"isLoadingServerConfig"],[113,43,108,41],[113,45,108,43,"isConfigured"],[113,57,108,55],[113,58,108,56],[113,59,108,57],[114,4,110,2],[114,10,110,8,"status"],[114,16,110,31],[114,19,110,34],[115,6,111,4,"isConfigured"],[115,18,111,16],[116,6,112,4,"isValidating"],[116,18,112,16],[116,20,112,18,"validationState"],[116,35,112,33],[116,36,112,34,"isValidating"],[116,48,112,46],[116,52,112,50,"isLoadingServerConfig"],[116,73,112,71],[117,6,113,4,"isValid"],[117,13,113,11],[117,15,113,13,"validationState"],[117,30,113,28],[117,31,113,29,"isValid"],[117,38,113,36],[118,6,114,4,"error"],[118,11,114,9],[118,13,114,11,"validationState"],[118,28,114,26],[118,29,114,27,"error"],[118,34,114,32],[119,6,115,4,"needsConfiguration"],[120,4,116,2],[120,5,116,3],[121,4,118,2],[121,11,118,9,"status"],[121,17,118,15],[122,2,119,0],[122,3,119,1],[123,2,119,2,"exports"],[123,9,119,2],[123,10,119,2,"useApiConfig"],[123,22,119,2],[123,25,119,2,"useApiConfig"],[123,37,119,2],[124,2,119,2,"_s"],[124,4,119,2],[124,5,13,13,"useApiConfig"],[124,17,13,25],[125,4,13,25],[125,12,14,62,"useSettingsStore"],[125,43,14,78],[126,2,14,78],[127,2,121,7],[127,8,121,13,"getApiConfigErrorMessage"],[127,32,121,37],[127,35,121,41,"status"],[127,41,121,64],[127,45,121,77],[128,4,122,2],[128,8,122,6,"status"],[128,14,122,12],[128,15,122,13,"needsConfiguration"],[128,33,122,31],[128,35,122,33],[129,6,123,4],[129,13,123,11],[129,35,123,33],[130,4,124,2],[131,4,126,2],[131,8,126,6,"status"],[131,14,126,12],[131,15,126,13,"error"],[131,20,126,18],[131,22,126,20],[132,6,127,4],[132,13,127,11,"status"],[132,19,127,17],[132,20,127,18,"error"],[132,25,127,23],[133,4,128,2],[134,4,130,2],[134,8,130,6,"status"],[134,14,130,12],[134,15,130,13,"isValidating"],[134,27,130,25],[134,29,130,27],[135,6,131,4],[135,13,131,11],[135,27,131,25],[136,4,132,2],[137,4,134,2],[137,8,134,6,"status"],[137,14,134,12],[137,15,134,13,"isValid"],[137,22,134,20],[137,27,134,25],[137,32,134,30],[137,34,134,32],[138,6,135,4],[138,13,135,11],[138,30,135,28],[139,4,136,2],[140,4,138,2],[140,11,138,9],[140,21,138,19],[141,2,139,0],[141,3,139,1],[142,2,139,2,"exports"],[142,9,139,2],[142,10,139,2,"getApiConfigErrorMessage"],[142,34,139,2],[142,37,139,2,"getApiConfigErrorMessage"],[142,61,139,2],[143,0,139,2]],"functionMap":{"names":["<global>","useApiConfig","useEffect$argument_0","validateConfig","setValidationState$argument_0","getApiConfigErrorMessage"],"mappings":"AAA;4BCY;YCgB;2BCU;yBCC,sDD;KDwC;GDM;YCG;yBEE,sDF;GDE;YCG;2BEG,iDF;2BEE;UFI;GDG;CDW;wCKE;CLkB"}},"type":"js/module"}]}