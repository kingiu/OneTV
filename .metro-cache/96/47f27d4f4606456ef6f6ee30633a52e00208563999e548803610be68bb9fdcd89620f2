{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":64,"column":46,"index":2437}}],"key":"7kvm5yrOpz4NYiDi6sn4qxa8DVQ="}},{"name":"react","data":{"asyncType":null,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":31,"index":31}}],"key":"a4EMkKqamYWCMMPV7UeQlqGQ+ks="}},{"name":"./NavigationBuilderContext","data":{"asyncType":null,"locs":[{"start":{"line":2,"column":0,"index":32},"end":{"line":2,"column":66,"index":98}}],"key":"y9eQQdj9MvCs7akL60igi3d/dsI="}},{"name":"./NavigationRouteContext","data":{"asyncType":null,"locs":[{"start":{"line":3,"column":0,"index":99},"end":{"line":3,"column":62,"index":161}}],"key":"HeyVDSY+CsJeYUdsxrU2U3K5dPs="}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = require(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = useOnPreventRemove;\n  exports.shouldPreventRemove = void 0;\n  var React = _interopRequireWildcard(require(_dependencyMap[1], \"react\"));\n  var _NavigationBuilderContext = _interopRequireDefault(require(_dependencyMap[2], \"./NavigationBuilderContext\"));\n  var _NavigationRouteContext = _interopRequireDefault(require(_dependencyMap[3], \"./NavigationRouteContext\"));\n  function _interopRequireWildcard(e, t) { if (\"function\" == typeof WeakMap) var r = new WeakMap(), n = new WeakMap(); return (_interopRequireWildcard = function (e, t) { if (!t && e && e.__esModule) return e; var o, i, f = { __proto__: null, default: e }; if (null === e || \"object\" != typeof e && \"function\" != typeof e) return f; if (o = t ? n : r) { if (o.has(e)) return o.get(e); o.set(e, f); } for (const t in e) \"default\" !== t && {}.hasOwnProperty.call(e, t) && ((i = (o = Object.defineProperty) && Object.getOwnPropertyDescriptor(e, t)) && (i.get || i.set) ? o(f, t, i) : f[t] = e[t]); return f; })(e, t); }\n  const VISITED_ROUTE_KEYS = Symbol('VISITED_ROUTE_KEYS');\n  const shouldPreventRemove = (emitter, beforeRemoveListeners, currentRoutes, nextRoutes, action) => {\n    const nextRouteKeys = nextRoutes.map(route => route.key);\n\n    // Call these in reverse order so last screens handle the event first\n    const removedRoutes = currentRoutes.filter(route => !nextRouteKeys.includes(route.key)).reverse();\n    const visitedRouteKeys =\n    // @ts-expect-error: add this property to mark that we've already emitted this action\n    action[VISITED_ROUTE_KEYS] ?? new Set();\n    const beforeRemoveAction = {\n      ...action,\n      [VISITED_ROUTE_KEYS]: visitedRouteKeys\n    };\n    for (const route of removedRoutes) {\n      var _beforeRemoveListener;\n      if (visitedRouteKeys.has(route.key)) {\n        // Skip if we've already emitted this action for this screen\n        continue;\n      }\n\n      // First, we need to check if any child screens want to prevent it\n      const isPrevented = (_beforeRemoveListener = beforeRemoveListeners[route.key]) === null || _beforeRemoveListener === void 0 ? void 0 : _beforeRemoveListener.call(beforeRemoveListeners, beforeRemoveAction);\n      if (isPrevented) {\n        return true;\n      }\n      visitedRouteKeys.add(route.key);\n      const event = emitter.emit({\n        type: 'beforeRemove',\n        target: route.key,\n        data: {\n          action: beforeRemoveAction\n        },\n        canPreventDefault: true\n      });\n      if (event.defaultPrevented) {\n        return true;\n      }\n    }\n    return false;\n  };\n  exports.shouldPreventRemove = shouldPreventRemove;\n  function useOnPreventRemove(_ref) {\n    let {\n      getState,\n      emitter,\n      beforeRemoveListeners\n    } = _ref;\n    const {\n      addKeyedListener\n    } = React.useContext(_NavigationBuilderContext.default);\n    const route = React.useContext(_NavigationRouteContext.default);\n    const routeKey = route === null || route === void 0 ? void 0 : route.key;\n    React.useEffect(() => {\n      if (routeKey) {\n        return addKeyedListener === null || addKeyedListener === void 0 ? void 0 : addKeyedListener('beforeRemove', routeKey, action => {\n          const state = getState();\n          return shouldPreventRemove(emitter, beforeRemoveListeners, state.routes, [], action);\n        });\n      }\n    }, [addKeyedListener, beforeRemoveListeners, emitter, getState, routeKey]);\n  }\n});","lineCount":73,"map":[[8,2,1,0],[8,6,1,0,"React"],[8,11,1,0],[8,14,1,0,"_interopRequireWildcard"],[8,37,1,0],[8,38,1,0,"require"],[8,45,1,0],[8,46,1,0,"_dependencyMap"],[8,60,1,0],[9,2,2,0],[9,6,2,0,"_NavigationBuilderContext"],[9,31,2,0],[9,34,2,0,"_interopRequireDefault"],[9,56,2,0],[9,57,2,0,"require"],[9,64,2,0],[9,65,2,0,"_dependencyMap"],[9,79,2,0],[10,2,3,0],[10,6,3,0,"_NavigationRouteContext"],[10,29,3,0],[10,32,3,0,"_interopRequireDefault"],[10,54,3,0],[10,55,3,0,"require"],[10,62,3,0],[10,63,3,0,"_dependencyMap"],[10,77,3,0],[11,2,3,62],[11,11,3,62,"_interopRequireWildcard"],[11,35,3,62,"e"],[11,36,3,62],[11,38,3,62,"t"],[11,39,3,62],[11,68,3,62,"WeakMap"],[11,75,3,62],[11,81,3,62,"r"],[11,82,3,62],[11,89,3,62,"WeakMap"],[11,96,3,62],[11,100,3,62,"n"],[11,101,3,62],[11,108,3,62,"WeakMap"],[11,115,3,62],[11,127,3,62,"_interopRequireWildcard"],[11,150,3,62],[11,162,3,62,"_interopRequireWildcard"],[11,163,3,62,"e"],[11,164,3,62],[11,166,3,62,"t"],[11,167,3,62],[11,176,3,62,"t"],[11,177,3,62],[11,181,3,62,"e"],[11,182,3,62],[11,186,3,62,"e"],[11,187,3,62],[11,188,3,62,"__esModule"],[11,198,3,62],[11,207,3,62,"e"],[11,208,3,62],[11,214,3,62,"o"],[11,215,3,62],[11,217,3,62,"i"],[11,218,3,62],[11,220,3,62,"f"],[11,221,3,62],[11,226,3,62,"__proto__"],[11,235,3,62],[11,243,3,62,"default"],[11,250,3,62],[11,252,3,62,"e"],[11,253,3,62],[11,270,3,62,"e"],[11,271,3,62],[11,294,3,62,"e"],[11,295,3,62],[11,320,3,62,"e"],[11,321,3,62],[11,330,3,62,"f"],[11,331,3,62],[11,337,3,62,"o"],[11,338,3,62],[11,341,3,62,"t"],[11,342,3,62],[11,345,3,62,"n"],[11,346,3,62],[11,349,3,62,"r"],[11,350,3,62],[11,358,3,62,"o"],[11,359,3,62],[11,360,3,62,"has"],[11,363,3,62],[11,364,3,62,"e"],[11,365,3,62],[11,375,3,62,"o"],[11,376,3,62],[11,377,3,62,"get"],[11,380,3,62],[11,381,3,62,"e"],[11,382,3,62],[11,385,3,62,"o"],[11,386,3,62],[11,387,3,62,"set"],[11,390,3,62],[11,391,3,62,"e"],[11,392,3,62],[11,394,3,62,"f"],[11,395,3,62],[11,411,3,62,"t"],[11,412,3,62],[11,416,3,62,"e"],[11,417,3,62],[11,433,3,62,"t"],[11,434,3,62],[11,441,3,62,"hasOwnProperty"],[11,455,3,62],[11,456,3,62,"call"],[11,460,3,62],[11,461,3,62,"e"],[11,462,3,62],[11,464,3,62,"t"],[11,465,3,62],[11,472,3,62,"i"],[11,473,3,62],[11,477,3,62,"o"],[11,478,3,62],[11,481,3,62,"Object"],[11,487,3,62],[11,488,3,62,"defineProperty"],[11,502,3,62],[11,507,3,62,"Object"],[11,513,3,62],[11,514,3,62,"getOwnPropertyDescriptor"],[11,538,3,62],[11,539,3,62,"e"],[11,540,3,62],[11,542,3,62,"t"],[11,543,3,62],[11,550,3,62,"i"],[11,551,3,62],[11,552,3,62,"get"],[11,555,3,62],[11,559,3,62,"i"],[11,560,3,62],[11,561,3,62,"set"],[11,564,3,62],[11,568,3,62,"o"],[11,569,3,62],[11,570,3,62,"f"],[11,571,3,62],[11,573,3,62,"t"],[11,574,3,62],[11,576,3,62,"i"],[11,577,3,62],[11,581,3,62,"f"],[11,582,3,62],[11,583,3,62,"t"],[11,584,3,62],[11,588,3,62,"e"],[11,589,3,62],[11,590,3,62,"t"],[11,591,3,62],[11,602,3,62,"f"],[11,603,3,62],[11,608,3,62,"e"],[11,609,3,62],[11,611,3,62,"t"],[11,612,3,62],[12,2,4,0],[12,8,4,6,"VISITED_ROUTE_KEYS"],[12,26,4,24],[12,29,4,27,"Symbol"],[12,35,4,33],[12,36,4,34],[12,56,4,54],[12,57,4,55],[13,2,5,7],[13,8,5,13,"shouldPreventRemove"],[13,27,5,32],[13,30,5,35,"shouldPreventRemove"],[13,31,5,36,"emitter"],[13,38,5,43],[13,40,5,45,"beforeRemoveListeners"],[13,61,5,66],[13,63,5,68,"currentRoutes"],[13,76,5,81],[13,78,5,83,"nextRoutes"],[13,88,5,93],[13,90,5,95,"action"],[13,96,5,101],[13,101,5,106],[14,4,6,2],[14,10,6,8,"nextRouteKeys"],[14,23,6,21],[14,26,6,24,"nextRoutes"],[14,36,6,34],[14,37,6,35,"map"],[14,40,6,38],[14,41,6,39,"route"],[14,46,6,44],[14,50,6,48,"route"],[14,55,6,53],[14,56,6,54,"key"],[14,59,6,57],[14,60,6,58],[16,4,8,2],[17,4,9,2],[17,10,9,8,"removedRoutes"],[17,23,9,21],[17,26,9,24,"currentRoutes"],[17,39,9,37],[17,40,9,38,"filter"],[17,46,9,44],[17,47,9,45,"route"],[17,52,9,50],[17,56,9,54],[17,57,9,55,"nextRouteKeys"],[17,70,9,68],[17,71,9,69,"includes"],[17,79,9,77],[17,80,9,78,"route"],[17,85,9,83],[17,86,9,84,"key"],[17,89,9,87],[17,90,9,88],[17,91,9,89],[17,92,9,90,"reverse"],[17,99,9,97],[17,100,9,98],[17,101,9,99],[18,4,10,2],[18,10,10,8,"visitedRouteKeys"],[18,26,10,24],[19,4,11,2],[20,4,12,2,"action"],[20,10,12,8],[20,11,12,9,"VISITED_ROUTE_KEYS"],[20,29,12,27],[20,30,12,28],[20,34,12,32],[20,38,12,36,"Set"],[20,41,12,39],[20,42,12,40],[20,43,12,41],[21,4,13,2],[21,10,13,8,"beforeRemoveAction"],[21,28,13,26],[21,31,13,29],[22,6,14,4],[22,9,14,7,"action"],[22,15,14,13],[23,6,15,4],[23,7,15,5,"VISITED_ROUTE_KEYS"],[23,25,15,23],[23,28,15,26,"visitedRouteKeys"],[24,4,16,2],[24,5,16,3],[25,4,17,2],[25,9,17,7],[25,15,17,13,"route"],[25,20,17,18],[25,24,17,22,"removedRoutes"],[25,37,17,35],[25,39,17,37],[26,6,18,4],[26,10,18,8,"_beforeRemoveListener"],[26,31,18,29],[27,6,19,4],[27,10,19,8,"visitedRouteKeys"],[27,26,19,24],[27,27,19,25,"has"],[27,30,19,28],[27,31,19,29,"route"],[27,36,19,34],[27,37,19,35,"key"],[27,40,19,38],[27,41,19,39],[27,43,19,41],[28,8,20,6],[29,8,21,6],[30,6,22,4],[32,6,24,4],[33,6,25,4],[33,12,25,10,"isPrevented"],[33,23,25,21],[33,26,25,24],[33,27,25,25,"_beforeRemoveListener"],[33,48,25,46],[33,51,25,49,"beforeRemoveListeners"],[33,72,25,70],[33,73,25,71,"route"],[33,78,25,76],[33,79,25,77,"key"],[33,82,25,80],[33,83,25,81],[33,89,25,87],[33,93,25,91],[33,97,25,95,"_beforeRemoveListener"],[33,118,25,116],[33,123,25,121],[33,128,25,126],[33,129,25,127],[33,132,25,130],[33,137,25,135],[33,138,25,136],[33,141,25,139,"_beforeRemoveListener"],[33,162,25,160],[33,163,25,161,"call"],[33,167,25,165],[33,168,25,166,"beforeRemoveListeners"],[33,189,25,187],[33,191,25,189,"beforeRemoveAction"],[33,209,25,207],[33,210,25,208],[34,6,26,4],[34,10,26,8,"isPrevented"],[34,21,26,19],[34,23,26,21],[35,8,27,6],[35,15,27,13],[35,19,27,17],[36,6,28,4],[37,6,29,4,"visitedRouteKeys"],[37,22,29,20],[37,23,29,21,"add"],[37,26,29,24],[37,27,29,25,"route"],[37,32,29,30],[37,33,29,31,"key"],[37,36,29,34],[37,37,29,35],[38,6,30,4],[38,12,30,10,"event"],[38,17,30,15],[38,20,30,18,"emitter"],[38,27,30,25],[38,28,30,26,"emit"],[38,32,30,30],[38,33,30,31],[39,8,31,6,"type"],[39,12,31,10],[39,14,31,12],[39,28,31,26],[40,8,32,6,"target"],[40,14,32,12],[40,16,32,14,"route"],[40,21,32,19],[40,22,32,20,"key"],[40,25,32,23],[41,8,33,6,"data"],[41,12,33,10],[41,14,33,12],[42,10,34,8,"action"],[42,16,34,14],[42,18,34,16,"beforeRemoveAction"],[43,8,35,6],[43,9,35,7],[44,8,36,6,"canPreventDefault"],[44,25,36,23],[44,27,36,25],[45,6,37,4],[45,7,37,5],[45,8,37,6],[46,6,38,4],[46,10,38,8,"event"],[46,15,38,13],[46,16,38,14,"defaultPrevented"],[46,32,38,30],[46,34,38,32],[47,8,39,6],[47,15,39,13],[47,19,39,17],[48,6,40,4],[49,4,41,2],[50,4,42,2],[50,11,42,9],[50,16,42,14],[51,2,43,0],[51,3,43,1],[52,2,43,2,"exports"],[52,9,43,2],[52,10,43,2,"shouldPreventRemove"],[52,29,43,2],[52,32,43,2,"shouldPreventRemove"],[52,51,43,2],[53,2,44,15],[53,11,44,24,"useOnPreventRemove"],[53,29,44,42,"useOnPreventRemove"],[53,30,44,43,"_ref"],[53,34,44,47],[53,36,44,49],[54,4,45,2],[54,8,45,6],[55,6,46,4,"getState"],[55,14,46,12],[56,6,47,4,"emitter"],[56,13,47,11],[57,6,48,4,"beforeRemoveListeners"],[58,4,49,2],[58,5,49,3],[58,8,49,6,"_ref"],[58,12,49,10],[59,4,50,2],[59,10,50,8],[60,6,51,4,"addKeyedListener"],[61,4,52,2],[61,5,52,3],[61,8,52,6,"React"],[61,13,52,11],[61,14,52,12,"useContext"],[61,24,52,22],[61,25,52,23,"NavigationBuilderContext"],[61,58,52,47],[61,59,52,48],[62,4,53,2],[62,10,53,8,"route"],[62,15,53,13],[62,18,53,16,"React"],[62,23,53,21],[62,24,53,22,"useContext"],[62,34,53,32],[62,35,53,33,"NavigationRouteContext"],[62,66,53,55],[62,67,53,56],[63,4,54,2],[63,10,54,8,"routeKey"],[63,18,54,16],[63,21,54,19,"route"],[63,26,54,24],[63,31,54,29],[63,35,54,33],[63,39,54,37,"route"],[63,44,54,42],[63,49,54,47],[63,54,54,52],[63,55,54,53],[63,58,54,56],[63,63,54,61],[63,64,54,62],[63,67,54,65,"route"],[63,72,54,70],[63,73,54,71,"key"],[63,76,54,74],[64,4,55,2,"React"],[64,9,55,7],[64,10,55,8,"useEffect"],[64,19,55,17],[64,20,55,18],[64,26,55,24],[65,6,56,4],[65,10,56,8,"routeKey"],[65,18,56,16],[65,20,56,18],[66,8,57,6],[66,15,57,13,"addKeyedListener"],[66,31,57,29],[66,36,57,34],[66,40,57,38],[66,44,57,42,"addKeyedListener"],[66,60,57,58],[66,65,57,63],[66,70,57,68],[66,71,57,69],[66,74,57,72],[66,79,57,77],[66,80,57,78],[66,83,57,81,"addKeyedListener"],[66,99,57,97],[66,100,57,98],[66,114,57,112],[66,116,57,114,"routeKey"],[66,124,57,122],[66,126,57,124,"action"],[66,132,57,130],[66,136,57,134],[67,10,58,8],[67,16,58,14,"state"],[67,21,58,19],[67,24,58,22,"getState"],[67,32,58,30],[67,33,58,31],[67,34,58,32],[68,10,59,8],[68,17,59,15,"shouldPreventRemove"],[68,36,59,34],[68,37,59,35,"emitter"],[68,44,59,42],[68,46,59,44,"beforeRemoveListeners"],[68,67,59,65],[68,69,59,67,"state"],[68,74,59,72],[68,75,59,73,"routes"],[68,81,59,79],[68,83,59,81],[68,85,59,83],[68,87,59,85,"action"],[68,93,59,91],[68,94,59,92],[69,8,60,6],[69,9,60,7],[69,10,60,8],[70,6,61,4],[71,4,62,2],[71,5,62,3],[71,7,62,5],[71,8,62,6,"addKeyedListener"],[71,24,62,22],[71,26,62,24,"beforeRemoveListeners"],[71,47,62,45],[71,49,62,47,"emitter"],[71,56,62,54],[71,58,62,56,"getState"],[71,66,62,64],[71,68,62,66,"routeKey"],[71,76,62,74],[71,77,62,75],[71,78,62,76],[72,2,63,0],[73,0,63,1]],"functionMap":{"names":["<global>","shouldPreventRemove","nextRoutes.map$argument_0","currentRoutes.filter$argument_0","useOnPreventRemove","React.useEffect$argument_0","addKeyedListener$argument_2"],"mappings":"AAA;mCCI;uCCC,kBD;6CEG,2CF;CDkC;eIC;kBCW;4HCE;ODG;GDE;CJC"}},"type":"js/module"}]}