{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":134,"column":0,"index":3360}}],"key":"7kvm5yrOpz4NYiDi6sn4qxa8DVQ="}},{"name":"react","data":{"asyncType":null,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":55,"index":55}}],"key":"a4EMkKqamYWCMMPV7UeQlqGQ+ks="}},{"name":"react-native-web/dist/index","data":{"asyncType":null,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":134,"column":0,"index":3360}}],"key":"HQdXwi+TEOkJBaUghAUOm/UKuzw="}},{"name":"@/stores/playerStore","data":{"asyncType":null,"locs":[{"start":{"line":3,"column":0,"index":115},"end":{"line":3,"column":50,"index":165}}],"key":"jza9oGwrWwCRqRJcTBeVqZHqd+Y="}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = require(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.useTVRemoteHandler = void 0;\n  var _react = require(_dependencyMap[1], \"react\");\n  var _index = require(_dependencyMap[2], \"react-native-web/dist/index\");\n  var _playerStore = _interopRequireDefault(require(_dependencyMap[3], \"@/stores/playerStore\"));\n  var _s = $RefreshSig$();\n  const SEEK_STEP = 20 * 1000; // 快进/快退的时间步长（毫秒）\n\n  // 定时器延迟时间（毫秒）\n  const CONTROLS_TIMEOUT = 5000;\n\n  /**\n   * 管理播放器控件的显示/隐藏、遥控器事件和自动隐藏定时器。\n   * @returns onScreenPress - 一个函数，用于处理屏幕点击事件，以显示控件并重置定时器。\n   */\n  const useTVRemoteHandler = () => {\n    _s();\n    const {\n      showControls,\n      setShowControls,\n      showEpisodeModal,\n      togglePlayPause,\n      seek\n    } = (0, _playerStore.default)();\n    const controlsTimer = (0, _react.useRef)(null);\n    const fastForwardIntervalRef = (0, _react.useRef)(null);\n\n    // 重置或启动隐藏控件的定时器\n    const resetTimer = (0, _react.useCallback)(() => {\n      // 清除之前的定时器\n      if (controlsTimer.current) {\n        clearTimeout(controlsTimer.current);\n      }\n      // 设置新的定时器\n      controlsTimer.current = setTimeout(() => {\n        setShowControls(false);\n      }, CONTROLS_TIMEOUT);\n    }, [setShowControls]);\n\n    // 当控件显示时，启动定时器\n    (0, _react.useEffect)(() => {\n      if (showControls) {\n        resetTimer();\n      } else {\n        // 如果控件被隐藏，清除定时器\n        if (controlsTimer.current) {\n          clearTimeout(controlsTimer.current);\n        }\n      }\n\n      // 组件卸载时清除定时器\n      return () => {\n        if (controlsTimer.current) {\n          clearTimeout(controlsTimer.current);\n        }\n      };\n    }, [showControls, resetTimer]);\n\n    // 组件卸载时清除快进定时器\n    (0, _react.useEffect)(() => {\n      return () => {\n        if (fastForwardIntervalRef.current) {\n          clearInterval(fastForwardIntervalRef.current);\n        }\n      };\n    }, []);\n\n    // 处理遥控器事件\n    const handleTVEvent = (0, _react.useCallback)(event => {\n      if (showEpisodeModal) {\n        return;\n      }\n      if (event.eventType === \"longRight\" || event.eventType === \"longLeft\") {\n        if (event.eventKeyAction === 1) {\n          if (fastForwardIntervalRef.current) {\n            clearInterval(fastForwardIntervalRef.current);\n            fastForwardIntervalRef.current = null;\n          }\n        }\n      }\n      resetTimer();\n      if (showControls) {\n        // 如果控制条已显示，则不处理后台的快进/快退等操作\n        // 避免与控制条上的按钮焦点冲突\n        return;\n      }\n      switch (event.eventType) {\n        case \"select\":\n          togglePlayPause();\n          setShowControls(true);\n          break;\n        case \"left\":\n          seek(-SEEK_STEP); // 快退15秒\n          break;\n        case \"longLeft\":\n          if (!fastForwardIntervalRef.current && event.eventKeyAction === 0) {\n            fastForwardIntervalRef.current = setInterval(() => {\n              seek(-SEEK_STEP);\n            }, 200);\n          }\n          break;\n        case \"right\":\n          seek(SEEK_STEP);\n          break;\n        case \"longRight\":\n          // 长按开始: 启动连续快进\n          if (!fastForwardIntervalRef.current && event.eventKeyAction === 0) {\n            fastForwardIntervalRef.current = setInterval(() => {\n              seek(SEEK_STEP);\n            }, 200);\n          }\n          break;\n        case \"down\":\n          setShowControls(true);\n          break;\n      }\n    }, [showControls, showEpisodeModal, setShowControls, resetTimer, togglePlayPause, seek]);\n    (0, _index.useTVEventHandler)(handleTVEvent);\n\n    // 处理屏幕点击事件\n    const onScreenPress = () => {\n      // 切换控件的显示状态\n      const newShowControls = !showControls;\n      setShowControls(newShowControls);\n\n      // 如果控件变为显示状态，则重置定时器\n      if (newShowControls) {\n        resetTimer();\n      }\n    };\n    return {\n      onScreenPress\n    };\n  };\n  exports.useTVRemoteHandler = useTVRemoteHandler;\n  _s(useTVRemoteHandler, \"tjCH28Lh3R+v2E6Pz9CA7u88X9M=\", false, function () {\n    return [_playerStore.default, _index.useTVEventHandler];\n  });\n});","lineCount":143,"map":[[7,2,1,0],[7,6,1,0,"_react"],[7,12,1,0],[7,15,1,0,"require"],[7,22,1,0],[7,23,1,0,"_dependencyMap"],[7,37,1,0],[8,2,1,55],[8,6,1,55,"_index"],[8,12,1,55],[8,15,1,55,"require"],[8,22,1,55],[8,23,1,55,"_dependencyMap"],[8,37,1,55],[9,2,3,0],[9,6,3,0,"_playerStore"],[9,18,3,0],[9,21,3,0,"_interopRequireDefault"],[9,43,3,0],[9,44,3,0,"require"],[9,51,3,0],[9,52,3,0,"_dependencyMap"],[9,66,3,0],[10,2,3,50],[10,6,3,50,"_s"],[10,8,3,50],[10,11,3,50,"$RefreshSig$"],[10,23,3,50],[11,2,5,0],[11,8,5,6,"SEEK_STEP"],[11,17,5,15],[11,20,5,18],[11,22,5,20],[11,25,5,23],[11,29,5,27],[11,30,5,28],[11,31,5,29],[13,2,7,0],[14,2,8,0],[14,8,8,6,"CONTROLS_TIMEOUT"],[14,24,8,22],[14,27,8,25],[14,31,8,29],[16,2,10,0],[17,0,11,0],[18,0,12,0],[19,0,13,0],[20,2,14,7],[20,8,14,13,"useTVRemoteHandler"],[20,26,14,31],[20,29,14,34,"useTVRemoteHandler"],[20,30,14,34],[20,35,14,40],[21,4,14,40,"_s"],[21,6,14,40],[22,4,15,2],[22,10,15,8],[23,6,15,10,"showControls"],[23,18,15,22],[24,6,15,24,"setShowControls"],[24,21,15,39],[25,6,15,41,"showEpisodeModal"],[25,22,15,57],[26,6,15,59,"togglePlayPause"],[26,21,15,74],[27,6,15,76,"seek"],[28,4,15,81],[28,5,15,82],[28,8,15,85],[28,12,15,85,"usePlayerStore"],[28,32,15,99],[28,34,15,100],[28,35,15,101],[29,4,17,2],[29,10,17,8,"controlsTimer"],[29,23,17,21],[29,26,17,24],[29,30,17,24,"useRef"],[29,43,17,30],[29,45,17,54],[29,49,17,58],[29,50,17,59],[30,4,18,2],[30,10,18,8,"fastForwardIntervalRef"],[30,32,18,30],[30,35,18,33],[30,39,18,33,"useRef"],[30,52,18,39],[30,54,18,63],[30,58,18,67],[30,59,18,68],[32,4,20,2],[33,4,21,2],[33,10,21,8,"resetTimer"],[33,20,21,18],[33,23,21,21],[33,27,21,21,"useCallback"],[33,45,21,32],[33,47,21,33],[33,53,21,39],[34,6,22,4],[35,6,23,4],[35,10,23,8,"controlsTimer"],[35,23,23,21],[35,24,23,22,"current"],[35,31,23,29],[35,33,23,31],[36,8,24,6,"clearTimeout"],[36,20,24,18],[36,21,24,19,"controlsTimer"],[36,34,24,32],[36,35,24,33,"current"],[36,42,24,40],[36,43,24,41],[37,6,25,4],[38,6,26,4],[39,6,27,4,"controlsTimer"],[39,19,27,17],[39,20,27,18,"current"],[39,27,27,25],[39,30,27,28,"setTimeout"],[39,40,27,38],[39,41,27,39],[39,47,27,45],[40,8,28,6,"setShowControls"],[40,23,28,21],[40,24,28,22],[40,29,28,27],[40,30,28,28],[41,6,29,4],[41,7,29,5],[41,9,29,7,"CONTROLS_TIMEOUT"],[41,25,29,23],[41,26,29,24],[42,4,30,2],[42,5,30,3],[42,7,30,5],[42,8,30,6,"setShowControls"],[42,23,30,21],[42,24,30,22],[42,25,30,23],[44,4,32,2],[45,4,33,2],[45,8,33,2,"useEffect"],[45,24,33,11],[45,26,33,12],[45,32,33,18],[46,6,34,4],[46,10,34,8,"showControls"],[46,22,34,20],[46,24,34,22],[47,8,35,6,"resetTimer"],[47,18,35,16],[47,19,35,17],[47,20,35,18],[48,6,36,4],[48,7,36,5],[48,13,36,11],[49,8,37,6],[50,8,38,6],[50,12,38,10,"controlsTimer"],[50,25,38,23],[50,26,38,24,"current"],[50,33,38,31],[50,35,38,33],[51,10,39,8,"clearTimeout"],[51,22,39,20],[51,23,39,21,"controlsTimer"],[51,36,39,34],[51,37,39,35,"current"],[51,44,39,42],[51,45,39,43],[52,8,40,6],[53,6,41,4],[55,6,43,4],[56,6,44,4],[56,13,44,11],[56,19,44,17],[57,8,45,6],[57,12,45,10,"controlsTimer"],[57,25,45,23],[57,26,45,24,"current"],[57,33,45,31],[57,35,45,33],[58,10,46,8,"clearTimeout"],[58,22,46,20],[58,23,46,21,"controlsTimer"],[58,36,46,34],[58,37,46,35,"current"],[58,44,46,42],[58,45,46,43],[59,8,47,6],[60,6,48,4],[60,7,48,5],[61,4,49,2],[61,5,49,3],[61,7,49,5],[61,8,49,6,"showControls"],[61,20,49,18],[61,22,49,20,"resetTimer"],[61,32,49,30],[61,33,49,31],[61,34,49,32],[63,4,51,2],[64,4,52,2],[64,8,52,2,"useEffect"],[64,24,52,11],[64,26,52,12],[64,32,52,18],[65,6,53,4],[65,13,53,11],[65,19,53,17],[66,8,54,6],[66,12,54,10,"fastForwardIntervalRef"],[66,34,54,32],[66,35,54,33,"current"],[66,42,54,40],[66,44,54,42],[67,10,55,8,"clearInterval"],[67,23,55,21],[67,24,55,22,"fastForwardIntervalRef"],[67,46,55,44],[67,47,55,45,"current"],[67,54,55,52],[67,55,55,53],[68,8,56,6],[69,6,57,4],[69,7,57,5],[70,4,58,2],[70,5,58,3],[70,7,58,5],[70,9,58,7],[70,10,58,8],[72,4,60,2],[73,4,61,2],[73,10,61,8,"handleTVEvent"],[73,23,61,21],[73,26,61,24],[73,30,61,24,"useCallback"],[73,48,61,35],[73,50,62,5,"event"],[73,55,62,19],[73,59,62,24],[74,6,63,6],[74,10,63,10,"showEpisodeModal"],[74,26,63,26],[74,28,63,28],[75,8,64,8],[76,6,65,6],[77,6,67,6],[77,10,67,10,"event"],[77,15,67,15],[77,16,67,16,"eventType"],[77,25,67,25],[77,30,67,30],[77,41,67,41],[77,45,67,45,"event"],[77,50,67,50],[77,51,67,51,"eventType"],[77,60,67,60],[77,65,67,65],[77,75,67,75],[77,77,67,77],[78,8,68,8],[78,12,68,12,"event"],[78,17,68,17],[78,18,68,18,"eventKeyAction"],[78,32,68,32],[78,37,68,37],[78,38,68,38],[78,40,68,40],[79,10,69,10],[79,14,69,14,"fastForwardIntervalRef"],[79,36,69,36],[79,37,69,37,"current"],[79,44,69,44],[79,46,69,46],[80,12,70,12,"clearInterval"],[80,25,70,25],[80,26,70,26,"fastForwardIntervalRef"],[80,48,70,48],[80,49,70,49,"current"],[80,56,70,56],[80,57,70,57],[81,12,71,12,"fastForwardIntervalRef"],[81,34,71,34],[81,35,71,35,"current"],[81,42,71,42],[81,45,71,45],[81,49,71,49],[82,10,72,10],[83,8,73,8],[84,6,74,6],[85,6,76,6,"resetTimer"],[85,16,76,16],[85,17,76,17],[85,18,76,18],[86,6,78,6],[86,10,78,10,"showControls"],[86,22,78,22],[86,24,78,24],[87,8,79,8],[88,8,80,8],[89,8,81,8],[90,6,82,6],[91,6,84,6],[91,14,84,14,"event"],[91,19,84,19],[91,20,84,20,"eventType"],[91,29,84,29],[92,8,85,8],[92,13,85,13],[92,21,85,21],[93,10,86,10,"togglePlayPause"],[93,25,86,25],[93,26,86,26],[93,27,86,27],[94,10,87,10,"setShowControls"],[94,25,87,25],[94,26,87,26],[94,30,87,30],[94,31,87,31],[95,10,88,10],[96,8,89,8],[96,13,89,13],[96,19,89,19],[97,10,90,10,"seek"],[97,14,90,14],[97,15,90,15],[97,16,90,16,"SEEK_STEP"],[97,25,90,25],[97,26,90,26],[97,27,90,27],[97,28,90,28],[98,10,91,10],[99,8,92,8],[99,13,92,13],[99,23,92,23],[100,10,93,10],[100,14,93,14],[100,15,93,15,"fastForwardIntervalRef"],[100,37,93,37],[100,38,93,38,"current"],[100,45,93,45],[100,49,93,49,"event"],[100,54,93,54],[100,55,93,55,"eventKeyAction"],[100,69,93,69],[100,74,93,74],[100,75,93,75],[100,77,93,77],[101,12,94,12,"fastForwardIntervalRef"],[101,34,94,34],[101,35,94,35,"current"],[101,42,94,42],[101,45,94,45,"setInterval"],[101,56,94,56],[101,57,94,57],[101,63,94,63],[102,14,95,14,"seek"],[102,18,95,18],[102,19,95,19],[102,20,95,20,"SEEK_STEP"],[102,29,95,29],[102,30,95,30],[103,12,96,12],[103,13,96,13],[103,15,96,15],[103,18,96,18],[103,19,96,19],[104,10,97,10],[105,10,98,10],[106,8,99,8],[106,13,99,13],[106,20,99,20],[107,10,100,10,"seek"],[107,14,100,14],[107,15,100,15,"SEEK_STEP"],[107,24,100,24],[107,25,100,25],[108,10,101,10],[109,8,102,8],[109,13,102,13],[109,24,102,24],[110,10,103,10],[111,10,104,10],[111,14,104,14],[111,15,104,15,"fastForwardIntervalRef"],[111,37,104,37],[111,38,104,38,"current"],[111,45,104,45],[111,49,104,49,"event"],[111,54,104,54],[111,55,104,55,"eventKeyAction"],[111,69,104,69],[111,74,104,74],[111,75,104,75],[111,77,104,77],[112,12,105,12,"fastForwardIntervalRef"],[112,34,105,34],[112,35,105,35,"current"],[112,42,105,42],[112,45,105,45,"setInterval"],[112,56,105,56],[112,57,105,57],[112,63,105,63],[113,14,106,14,"seek"],[113,18,106,18],[113,19,106,19,"SEEK_STEP"],[113,28,106,28],[113,29,106,29],[114,12,107,12],[114,13,107,13],[114,15,107,15],[114,18,107,18],[114,19,107,19],[115,10,108,10],[116,10,109,10],[117,8,110,8],[117,13,110,13],[117,19,110,19],[118,10,111,10,"setShowControls"],[118,25,111,25],[118,26,111,26],[118,30,111,30],[118,31,111,31],[119,10,112,10],[120,6,113,6],[121,4,114,4],[121,5,114,5],[121,7,115,4],[121,8,115,5,"showControls"],[121,20,115,17],[121,22,115,19,"showEpisodeModal"],[121,38,115,35],[121,40,115,37,"setShowControls"],[121,55,115,52],[121,57,115,54,"resetTimer"],[121,67,115,64],[121,69,115,66,"togglePlayPause"],[121,84,115,81],[121,86,115,83,"seek"],[121,90,115,87],[121,91,116,2],[121,92,116,3],[122,4,118,2],[122,8,118,2,"useTVEventHandler"],[122,32,118,19],[122,34,118,20,"handleTVEvent"],[122,47,118,33],[122,48,118,34],[124,4,120,2],[125,4,121,2],[125,10,121,8,"onScreenPress"],[125,23,121,21],[125,26,121,24,"onScreenPress"],[125,27,121,24],[125,32,121,30],[126,6,122,4],[127,6,123,4],[127,12,123,10,"newShowControls"],[127,27,123,25],[127,30,123,28],[127,31,123,29,"showControls"],[127,43,123,41],[128,6,124,4,"setShowControls"],[128,21,124,19],[128,22,124,20,"newShowControls"],[128,37,124,35],[128,38,124,36],[130,6,126,4],[131,6,127,4],[131,10,127,8,"newShowControls"],[131,25,127,23],[131,27,127,25],[132,8,128,6,"resetTimer"],[132,18,128,16],[132,19,128,17],[132,20,128,18],[133,6,129,4],[134,4,130,2],[134,5,130,3],[135,4,132,2],[135,11,132,9],[136,6,132,11,"onScreenPress"],[137,4,132,25],[137,5,132,26],[138,2,133,0],[138,3,133,1],[139,2,133,2,"exports"],[139,9,133,2],[139,10,133,2,"useTVRemoteHandler"],[139,28,133,2],[139,31,133,2,"useTVRemoteHandler"],[139,49,133,2],[140,2,133,2,"_s"],[140,4,133,2],[140,5,14,13,"useTVRemoteHandler"],[140,23,14,31],[141,4,14,31],[141,12,15,85,"usePlayerStore"],[141,32,15,99],[141,34,118,2,"useTVEventHandler"],[141,58,118,19],[142,2,118,19],[143,0,118,19]],"functionMap":{"names":["<global>","useTVRemoteHandler","resetTimer","setTimeout$argument_0","useEffect$argument_0","<anonymous>","handleTVEvent","setInterval$argument_0","onScreenPress"],"mappings":"AAA;kCCa;iCCO;uCCM;KDE;GDC;YGG;WCW;KDI;GHC;YGG;WCC;KDI;GHC;IKI;yDCgC;aDE;yDCS;aDE;KLO;wBOO;GPS;CDG"}},"type":"js/module"}]}