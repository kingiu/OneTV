{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":136,"column":0,"index":3464}}],"key":"7kvm5yrOpz4NYiDi6sn4qxa8DVQ="}},{"name":"react","data":{"asyncType":null,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":55,"index":55}}],"key":"a4EMkKqamYWCMMPV7UeQlqGQ+ks="}},{"name":"@/stores/playerStore","data":{"asyncType":null,"locs":[{"start":{"line":5,"column":0,"index":219},"end":{"line":5,"column":50,"index":269}}],"key":"jza9oGwrWwCRqRJcTBeVqZHqd+Y="}},{"name":"react-native","data":{"asyncType":null,"locs":[{"start":{"line":3,"column":31,"index":122},"end":{"line":3,"column":54,"index":145}},{"start":{"line":4,"column":21,"index":186},"end":{"line":4,"column":44,"index":209}}],"key":"XEo4Z+Aarw9Y7I7ZLBt66vGLAVQ="}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = require(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.useTVRemoteHandler = void 0;\n  var _react = require(_dependencyMap[1], \"react\");\n  var _playerStore = _interopRequireDefault(require(_dependencyMap[2], \"@/stores/playerStore\"));\n  var _s = $RefreshSig$();\n  // 使用类型断言来解决找不到react-native声明文件的问题\n  const useTVEventHandler = require(_dependencyMap[3], \"react-native\").useTVEventHandler;\n  const HWEvent = require(_dependencyMap[3], \"react-native\").HWEvent;\n  const SEEK_STEP = 20 * 1000; // 快进/快退的时间步长（毫秒）\n\n  // 定时器延迟时间（毫秒）\n  const CONTROLS_TIMEOUT = 5000;\n\n  /**\n   * 管理播放器控件的显示/隐藏、遥控器事件和自动隐藏定时器。\n   * @returns onScreenPress - 一个函数，用于处理屏幕点击事件，以显示控件并重置定时器。\n   */\n  const useTVRemoteHandler = () => {\n    _s();\n    const {\n      showControls,\n      setShowControls,\n      showEpisodeModal,\n      togglePlayPause,\n      seek\n    } = (0, _playerStore.default)();\n    const controlsTimer = (0, _react.useRef)(null);\n    const fastForwardIntervalRef = (0, _react.useRef)(null);\n\n    // 重置或启动隐藏控件的定时器\n    const resetTimer = (0, _react.useCallback)(() => {\n      // 清除之前的定时器\n      if (controlsTimer.current) {\n        clearTimeout(controlsTimer.current);\n      }\n      // 设置新的定时器\n      controlsTimer.current = setTimeout(() => {\n        setShowControls(false);\n      }, CONTROLS_TIMEOUT);\n    }, [setShowControls]);\n\n    // 当控件显示时，启动定时器\n    (0, _react.useEffect)(() => {\n      if (showControls) {\n        resetTimer();\n      } else {\n        // 如果控件被隐藏，清除定时器\n        if (controlsTimer.current) {\n          clearTimeout(controlsTimer.current);\n        }\n      }\n\n      // 组件卸载时清除定时器\n      return () => {\n        if (controlsTimer.current) {\n          clearTimeout(controlsTimer.current);\n        }\n      };\n    }, [showControls, resetTimer]);\n\n    // 组件卸载时清除快进定时器\n    (0, _react.useEffect)(() => {\n      return () => {\n        if (fastForwardIntervalRef.current) {\n          clearInterval(fastForwardIntervalRef.current);\n        }\n      };\n    }, []);\n\n    // 处理遥控器事件\n    const handleTVEvent = (0, _react.useCallback)(event => {\n      if (showEpisodeModal) {\n        return;\n      }\n      if (event.eventType === \"longRight\" || event.eventType === \"longLeft\") {\n        if (event.eventKeyAction === 1) {\n          if (fastForwardIntervalRef.current) {\n            clearInterval(fastForwardIntervalRef.current);\n            fastForwardIntervalRef.current = null;\n          }\n        }\n      }\n      resetTimer();\n      if (showControls) {\n        // 如果控制条已显示，则不处理后台的快进/快退等操作\n        // 避免与控制条上的按钮焦点冲突\n        return;\n      }\n      switch (event.eventType) {\n        case \"select\":\n          togglePlayPause();\n          setShowControls(true);\n          break;\n        case \"left\":\n          seek(-SEEK_STEP); // 快退15秒\n          break;\n        case \"longLeft\":\n          if (!fastForwardIntervalRef.current && event.eventKeyAction === 0) {\n            fastForwardIntervalRef.current = setInterval(() => {\n              seek(-SEEK_STEP);\n            }, 200);\n          }\n          break;\n        case \"right\":\n          seek(SEEK_STEP);\n          break;\n        case \"longRight\":\n          // 长按开始: 启动连续快进\n          if (!fastForwardIntervalRef.current && event.eventKeyAction === 0) {\n            fastForwardIntervalRef.current = setInterval(() => {\n              seek(SEEK_STEP);\n            }, 200);\n          }\n          break;\n        case \"down\":\n          setShowControls(true);\n          break;\n      }\n    }, [showControls, showEpisodeModal, setShowControls, resetTimer, togglePlayPause, seek]);\n    useTVEventHandler(handleTVEvent);\n\n    // 处理屏幕点击事件\n    const onScreenPress = () => {\n      // 切换控件的显示状态\n      const newShowControls = !showControls;\n      setShowControls(newShowControls);\n\n      // 如果控件变为显示状态，则重置定时器\n      if (newShowControls) {\n        resetTimer();\n      }\n    };\n    return {\n      onScreenPress\n    };\n  };\n  exports.useTVRemoteHandler = useTVRemoteHandler;\n  _s(useTVRemoteHandler, \"tjCH28Lh3R+v2E6Pz9CA7u88X9M=\", false, function () {\n    return [_playerStore.default, useTVEventHandler];\n  });\n});","lineCount":145,"map":[[7,2,1,0],[7,6,1,0,"_react"],[7,12,1,0],[7,15,1,0,"require"],[7,22,1,0],[7,23,1,0,"_dependencyMap"],[7,37,1,0],[8,2,5,0],[8,6,5,0,"_playerStore"],[8,18,5,0],[8,21,5,0,"_interopRequireDefault"],[8,43,5,0],[8,44,5,0,"require"],[8,51,5,0],[8,52,5,0,"_dependencyMap"],[8,66,5,0],[9,2,5,50],[9,6,5,50,"_s"],[9,8,5,50],[9,11,5,50,"$RefreshSig$"],[9,23,5,50],[10,2,2,0],[11,2,3,0],[11,8,3,6,"useTVEventHandler"],[11,25,3,28],[11,28,3,31,"require"],[11,35,3,38],[11,36,3,38,"_dependencyMap"],[11,50,3,38],[11,69,3,53],[11,70,3,54],[11,71,3,55,"useTVEventHandler"],[11,88,3,72],[12,2,4,0],[12,8,4,6,"HWEvent"],[12,15,4,18],[12,18,4,21,"require"],[12,25,4,28],[12,26,4,28,"_dependencyMap"],[12,40,4,28],[12,59,4,43],[12,60,4,44],[12,61,4,45,"HWEvent"],[12,68,4,52],[13,2,7,0],[13,8,7,6,"SEEK_STEP"],[13,17,7,15],[13,20,7,18],[13,22,7,20],[13,25,7,23],[13,29,7,27],[13,30,7,28],[13,31,7,29],[15,2,9,0],[16,2,10,0],[16,8,10,6,"CONTROLS_TIMEOUT"],[16,24,10,22],[16,27,10,25],[16,31,10,29],[18,2,12,0],[19,0,13,0],[20,0,14,0],[21,0,15,0],[22,2,16,7],[22,8,16,13,"useTVRemoteHandler"],[22,26,16,31],[22,29,16,34,"useTVRemoteHandler"],[22,30,16,34],[22,35,16,40],[23,4,16,40,"_s"],[23,6,16,40],[24,4,17,2],[24,10,17,8],[25,6,17,10,"showControls"],[25,18,17,22],[26,6,17,24,"setShowControls"],[26,21,17,39],[27,6,17,41,"showEpisodeModal"],[27,22,17,57],[28,6,17,59,"togglePlayPause"],[28,21,17,74],[29,6,17,76,"seek"],[30,4,17,81],[30,5,17,82],[30,8,17,85],[30,12,17,85,"usePlayerStore"],[30,32,17,99],[30,34,17,100],[30,35,17,101],[31,4,19,2],[31,10,19,8,"controlsTimer"],[31,23,19,21],[31,26,19,24],[31,30,19,24,"useRef"],[31,43,19,30],[31,45,19,54],[31,49,19,58],[31,50,19,59],[32,4,20,2],[32,10,20,8,"fastForwardIntervalRef"],[32,32,20,30],[32,35,20,33],[32,39,20,33,"useRef"],[32,52,20,39],[32,54,20,63],[32,58,20,67],[32,59,20,68],[34,4,22,2],[35,4,23,2],[35,10,23,8,"resetTimer"],[35,20,23,18],[35,23,23,21],[35,27,23,21,"useCallback"],[35,45,23,32],[35,47,23,33],[35,53,23,39],[36,6,24,4],[37,6,25,4],[37,10,25,8,"controlsTimer"],[37,23,25,21],[37,24,25,22,"current"],[37,31,25,29],[37,33,25,31],[38,8,26,6,"clearTimeout"],[38,20,26,18],[38,21,26,19,"controlsTimer"],[38,34,26,32],[38,35,26,33,"current"],[38,42,26,40],[38,43,26,41],[39,6,27,4],[40,6,28,4],[41,6,29,4,"controlsTimer"],[41,19,29,17],[41,20,29,18,"current"],[41,27,29,25],[41,30,29,28,"setTimeout"],[41,40,29,38],[41,41,29,39],[41,47,29,45],[42,8,30,6,"setShowControls"],[42,23,30,21],[42,24,30,22],[42,29,30,27],[42,30,30,28],[43,6,31,4],[43,7,31,5],[43,9,31,7,"CONTROLS_TIMEOUT"],[43,25,31,23],[43,26,31,24],[44,4,32,2],[44,5,32,3],[44,7,32,5],[44,8,32,6,"setShowControls"],[44,23,32,21],[44,24,32,22],[44,25,32,23],[46,4,34,2],[47,4,35,2],[47,8,35,2,"useEffect"],[47,24,35,11],[47,26,35,12],[47,32,35,18],[48,6,36,4],[48,10,36,8,"showControls"],[48,22,36,20],[48,24,36,22],[49,8,37,6,"resetTimer"],[49,18,37,16],[49,19,37,17],[49,20,37,18],[50,6,38,4],[50,7,38,5],[50,13,38,11],[51,8,39,6],[52,8,40,6],[52,12,40,10,"controlsTimer"],[52,25,40,23],[52,26,40,24,"current"],[52,33,40,31],[52,35,40,33],[53,10,41,8,"clearTimeout"],[53,22,41,20],[53,23,41,21,"controlsTimer"],[53,36,41,34],[53,37,41,35,"current"],[53,44,41,42],[53,45,41,43],[54,8,42,6],[55,6,43,4],[57,6,45,4],[58,6,46,4],[58,13,46,11],[58,19,46,17],[59,8,47,6],[59,12,47,10,"controlsTimer"],[59,25,47,23],[59,26,47,24,"current"],[59,33,47,31],[59,35,47,33],[60,10,48,8,"clearTimeout"],[60,22,48,20],[60,23,48,21,"controlsTimer"],[60,36,48,34],[60,37,48,35,"current"],[60,44,48,42],[60,45,48,43],[61,8,49,6],[62,6,50,4],[62,7,50,5],[63,4,51,2],[63,5,51,3],[63,7,51,5],[63,8,51,6,"showControls"],[63,20,51,18],[63,22,51,20,"resetTimer"],[63,32,51,30],[63,33,51,31],[63,34,51,32],[65,4,53,2],[66,4,54,2],[66,8,54,2,"useEffect"],[66,24,54,11],[66,26,54,12],[66,32,54,18],[67,6,55,4],[67,13,55,11],[67,19,55,17],[68,8,56,6],[68,12,56,10,"fastForwardIntervalRef"],[68,34,56,32],[68,35,56,33,"current"],[68,42,56,40],[68,44,56,42],[69,10,57,8,"clearInterval"],[69,23,57,21],[69,24,57,22,"fastForwardIntervalRef"],[69,46,57,44],[69,47,57,45,"current"],[69,54,57,52],[69,55,57,53],[70,8,58,6],[71,6,59,4],[71,7,59,5],[72,4,60,2],[72,5,60,3],[72,7,60,5],[72,9,60,7],[72,10,60,8],[74,4,62,2],[75,4,63,2],[75,10,63,8,"handleTVEvent"],[75,23,63,21],[75,26,63,24],[75,30,63,24,"useCallback"],[75,48,63,35],[75,50,64,5,"event"],[75,55,64,19],[75,59,64,24],[76,6,65,6],[76,10,65,10,"showEpisodeModal"],[76,26,65,26],[76,28,65,28],[77,8,66,8],[78,6,67,6],[79,6,69,6],[79,10,69,10,"event"],[79,15,69,15],[79,16,69,16,"eventType"],[79,25,69,25],[79,30,69,30],[79,41,69,41],[79,45,69,45,"event"],[79,50,69,50],[79,51,69,51,"eventType"],[79,60,69,60],[79,65,69,65],[79,75,69,75],[79,77,69,77],[80,8,70,8],[80,12,70,12,"event"],[80,17,70,17],[80,18,70,18,"eventKeyAction"],[80,32,70,32],[80,37,70,37],[80,38,70,38],[80,40,70,40],[81,10,71,10],[81,14,71,14,"fastForwardIntervalRef"],[81,36,71,36],[81,37,71,37,"current"],[81,44,71,44],[81,46,71,46],[82,12,72,12,"clearInterval"],[82,25,72,25],[82,26,72,26,"fastForwardIntervalRef"],[82,48,72,48],[82,49,72,49,"current"],[82,56,72,56],[82,57,72,57],[83,12,73,12,"fastForwardIntervalRef"],[83,34,73,34],[83,35,73,35,"current"],[83,42,73,42],[83,45,73,45],[83,49,73,49],[84,10,74,10],[85,8,75,8],[86,6,76,6],[87,6,78,6,"resetTimer"],[87,16,78,16],[87,17,78,17],[87,18,78,18],[88,6,80,6],[88,10,80,10,"showControls"],[88,22,80,22],[88,24,80,24],[89,8,81,8],[90,8,82,8],[91,8,83,8],[92,6,84,6],[93,6,86,6],[93,14,86,14,"event"],[93,19,86,19],[93,20,86,20,"eventType"],[93,29,86,29],[94,8,87,8],[94,13,87,13],[94,21,87,21],[95,10,88,10,"togglePlayPause"],[95,25,88,25],[95,26,88,26],[95,27,88,27],[96,10,89,10,"setShowControls"],[96,25,89,25],[96,26,89,26],[96,30,89,30],[96,31,89,31],[97,10,90,10],[98,8,91,8],[98,13,91,13],[98,19,91,19],[99,10,92,10,"seek"],[99,14,92,14],[99,15,92,15],[99,16,92,16,"SEEK_STEP"],[99,25,92,25],[99,26,92,26],[99,27,92,27],[99,28,92,28],[100,10,93,10],[101,8,94,8],[101,13,94,13],[101,23,94,23],[102,10,95,10],[102,14,95,14],[102,15,95,15,"fastForwardIntervalRef"],[102,37,95,37],[102,38,95,38,"current"],[102,45,95,45],[102,49,95,49,"event"],[102,54,95,54],[102,55,95,55,"eventKeyAction"],[102,69,95,69],[102,74,95,74],[102,75,95,75],[102,77,95,77],[103,12,96,12,"fastForwardIntervalRef"],[103,34,96,34],[103,35,96,35,"current"],[103,42,96,42],[103,45,96,45,"setInterval"],[103,56,96,56],[103,57,96,57],[103,63,96,63],[104,14,97,14,"seek"],[104,18,97,18],[104,19,97,19],[104,20,97,20,"SEEK_STEP"],[104,29,97,29],[104,30,97,30],[105,12,98,12],[105,13,98,13],[105,15,98,15],[105,18,98,18],[105,19,98,19],[106,10,99,10],[107,10,100,10],[108,8,101,8],[108,13,101,13],[108,20,101,20],[109,10,102,10,"seek"],[109,14,102,14],[109,15,102,15,"SEEK_STEP"],[109,24,102,24],[109,25,102,25],[110,10,103,10],[111,8,104,8],[111,13,104,13],[111,24,104,24],[112,10,105,10],[113,10,106,10],[113,14,106,14],[113,15,106,15,"fastForwardIntervalRef"],[113,37,106,37],[113,38,106,38,"current"],[113,45,106,45],[113,49,106,49,"event"],[113,54,106,54],[113,55,106,55,"eventKeyAction"],[113,69,106,69],[113,74,106,74],[113,75,106,75],[113,77,106,77],[114,12,107,12,"fastForwardIntervalRef"],[114,34,107,34],[114,35,107,35,"current"],[114,42,107,42],[114,45,107,45,"setInterval"],[114,56,107,56],[114,57,107,57],[114,63,107,63],[115,14,108,14,"seek"],[115,18,108,18],[115,19,108,19,"SEEK_STEP"],[115,28,108,28],[115,29,108,29],[116,12,109,12],[116,13,109,13],[116,15,109,15],[116,18,109,18],[116,19,109,19],[117,10,110,10],[118,10,111,10],[119,8,112,8],[119,13,112,13],[119,19,112,19],[120,10,113,10,"setShowControls"],[120,25,113,25],[120,26,113,26],[120,30,113,30],[120,31,113,31],[121,10,114,10],[122,6,115,6],[123,4,116,4],[123,5,116,5],[123,7,117,4],[123,8,117,5,"showControls"],[123,20,117,17],[123,22,117,19,"showEpisodeModal"],[123,38,117,35],[123,40,117,37,"setShowControls"],[123,55,117,52],[123,57,117,54,"resetTimer"],[123,67,117,64],[123,69,117,66,"togglePlayPause"],[123,84,117,81],[123,86,117,83,"seek"],[123,90,117,87],[123,91,118,2],[123,92,118,3],[124,4,120,2,"useTVEventHandler"],[124,21,120,19],[124,22,120,20,"handleTVEvent"],[124,35,120,33],[124,36,120,34],[126,4,122,2],[127,4,123,2],[127,10,123,8,"onScreenPress"],[127,23,123,21],[127,26,123,24,"onScreenPress"],[127,27,123,24],[127,32,123,30],[128,6,124,4],[129,6,125,4],[129,12,125,10,"newShowControls"],[129,27,125,25],[129,30,125,28],[129,31,125,29,"showControls"],[129,43,125,41],[130,6,126,4,"setShowControls"],[130,21,126,19],[130,22,126,20,"newShowControls"],[130,37,126,35],[130,38,126,36],[132,6,128,4],[133,6,129,4],[133,10,129,8,"newShowControls"],[133,25,129,23],[133,27,129,25],[134,8,130,6,"resetTimer"],[134,18,130,16],[134,19,130,17],[134,20,130,18],[135,6,131,4],[136,4,132,2],[136,5,132,3],[137,4,134,2],[137,11,134,9],[138,6,134,11,"onScreenPress"],[139,4,134,25],[139,5,134,26],[140,2,135,0],[140,3,135,1],[141,2,135,2,"exports"],[141,9,135,2],[141,10,135,2,"useTVRemoteHandler"],[141,28,135,2],[141,31,135,2,"useTVRemoteHandler"],[141,49,135,2],[142,2,135,2,"_s"],[142,4,135,2],[142,5,16,13,"useTVRemoteHandler"],[142,23,16,31],[143,4,16,31],[143,12,17,85,"usePlayerStore"],[143,32,17,99],[143,34,120,2,"useTVEventHandler"],[143,51,120,19],[144,2,120,19],[145,0,120,19]],"functionMap":{"names":["<global>","useTVRemoteHandler","resetTimer","setTimeout$argument_0","useEffect$argument_0","<anonymous>","handleTVEvent","setInterval$argument_0","onScreenPress"],"mappings":"AAA;kCCe;iCCO;uCCM;KDE;GDC;YGG;WCW;KDI;GHC;YGG;WCC;KDI;GHC;IKI;yDCgC;aDE;yDCS;aDE;KLO;wBOO;GPS;CDG"}},"type":"js/module"}]}